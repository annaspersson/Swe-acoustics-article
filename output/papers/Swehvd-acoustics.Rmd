---
title             : "The acoustic characteristics of Swedish vowels"
shorttitle        : "Swedish vowel acoustics"
date              : "`r format(Sys.time(), '%B %d, %Y')`"

author:
  - name: Anna Persson
    affiliation: '1'
    corresponding: yes
    address: 'Department of Swedish Language and Multilingualism, Stockholm University'
    city: Stockholm
    zip: SE-106 91
    country: Sweden
    email: 'anna.persson@su.se'
    phone: '+46730573273'

affiliation:
  - id: '1'
    department: Department of Swedish Language and Multilingualism
    institution: 'Department of Swedish Language and Multilingualism, Stockholm University'
    city: Stockholm
    country: Sweden

abstract: The Swedish vowel space is relatively densely populated with 21 categories that differ in quality and quantity. Existing descriptions of the entire space rest on recordings made in the late 1990s or earlier, while recent work in general has focused on sub-sets of the space. The present paper reports on static and dynamic acoustic analyses of the entire vowel space using a recently released database of *h-VOWEL-d* words (SwehVd). The results highlight the importance of static and dynamic spectral and temporal cues for Swedish vowel category distinction. The first two formants and vowel duration are the primary acoustic cues to vowel identity, however, the third formant contributes to increased category separability for neighboring contrasts presumed to differ in lip-rounding. In addition, even though all long-short vowel pairs differed systematically in duration, they also display considerable spectral differences, suggesting that quantity distinctions are not separate from quality distinctions in Swedish. The dynamic analysis further suggests formant movements in both long and short vowels, with [e:] and [o:] displaying clearer patterns of diphthongization.

keywords          : "vowels, category separability, formant dynamics"
wordcount         : "X"

bibliography      : ["latex-stuff/librarySweAcoust.bib", "latex-stuff/packages.bib"]
link-citations    : yes
csl               : latex-stuff/apa-6th-edition.csl

floatsintext      : yes
figurelist        : yes
tablelist         : yes
footnotelist      : no
linenumbers       : yes
numbersections    : true
mask              : no
draft             : no

header-includes:
 - \usepackage{animate}
 - \usepackage{amsmath}
 - \usepackage{tikz}
 - \usetikzlibrary{bayesnet}
 - \usepackage{booktabs}
 - \usepackage{siunitx}
 - \usepackage{soul}
 - \usepackage{tabto}
 - \usepackage{xcolor}
 - \usepackage{colortbl}
 - \usepackage{placeins}
 - \setstcolor{red}
 - \usepackage{sectsty}
 - \sectionfont{\color{black}}
 - \subsectionfont{\color{black}}
 - \subsubsectionfont{\color{black}}
 - \usepackage{setspace}\doublespacing
 - \usepackage{subfig}
# - \usepackage{lscape}
 - \usepackage{pdflscape}
 - \extrafloats{100} 
# - \captionsetup[figure]{textformat=empty}

documentclass     : "apa6"
classoption       : "man"
fontsize          : 12pt
output:
  papaja::apa6_pdf:
    latex_engine: xelatex
    keep_tex: true
    extra_dependencies: ["pdflscape"]
    error: true
    includes:
      in_header: latex-stuff/header.tex
always_allow_html: true
---

```{r libraries, include=FALSE, message=FALSE}
library(curl)             # Check availability of internet for install of remote libraries

# Install remotes package if necessary
if(!requireNamespace("remotes", quietly = TRUE)) if (has_internet()) install.packages("remotes")
# Install the stable development version from GitHub
#if (has_internet()) remotes::install_github("crsh/papaja")
library(papaja)           # APA formatted ms

library(tidyverse)        # data wrangling and plotting
library(magrittr)         # pipes, my friend, we need pipes
#library(assertthat)       # for error checking
library(rlang)            # quosures and unquoting
library(ggforce)          # correlation matrices
library(plotly)           # for interactive HTML plots
library(patchwork)       # for plotting many plots
library(mvtnorm)          # for identifying outliers
library(mgcv)             # for running generalized additive mixed models
library(gtsummary)        # for converting gamms to tables
library(itsadug)          # for plotting generalized additive mixed models
library(lme4)             # for running linear mixed-effects models

library(linguisticsdown)  # for inserting IPA symbols
library(kableExtra)       # for styling html format
library(modelr)
```

```{r setup, include=FALSE}
library(knitr)

# Set knit defaults for code chunks
opts_chunk$set(
  fig.path = "../../figures/knitted/",
  dpi=300,
  dev=c('jpeg', 'png'), # default format of figures
  comment="",
  echo=FALSE, warning=FALSE, message=FALSE,
  cache=TRUE)

# some useful formatting functions for output of knitting
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$size != "normalsize", paste0("\n \\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})

color_block = function(color) {
  function(x, options) sprintf('\\color{%s}\\begin{verbatim}%s\\end{verbatim}\\color{black}', color, x)
}
knitr::knit_hooks$set(error = color_block('red'))
knitr::knit_hooks$set(warning = color_block('orange'))
```

```{r functions-and-pipes, include=FALSE}
source("constants_functions.R")

myGplot.defaults("paper")

options(knitr.table.format = "latex")

base.width = 2.5
base.height = 2.5
base_size = 10

INCLUDE_SI = T     # switch on/off to include SI.
```

\setcounter{page}{1}

# Introduction {#sec:intro}
The Swedish vowel inventory consists of 21 categories that differ in spectral (formant frequencies) and temporal cues (duration). It forms a typologically rather complex space, characterized by a systematic quantity distinction resulting in 9 long and short vowel pairs, 3 different levels of lip-rounding, and contextually conditioned allophones to /`r linguisticsdown::cond_cmpl("ɛ")`/ and /`r linguisticsdown::cond_cmpl("ø")`/ in position before /r/ or any retroflex segments. Given the crowdedness of the space and resulting category overlap for some vowels, previous work has reported on the hypothesized importance of additional cues besides F1 and F2, such as the third formant (F3) for rounded vs. unrounded categories [e.g., @fant1959; @fant1969; @fujimura1967; @kuronen2000], duration for certain long-short vowel pairs [@behne-kirk1997], formant movements for some front contrasts [@kuronen2000; @pelzer-boersma2019], as well as the need to look beyond static point estimates of the two primary determinants to vowel identity cross-linguistically, the first two formants [F1 and F2, e.g., @joos1948; @Ladefoged1957; @peterson1961; @nearey-assmann1986]. Single-point estimates extracted from the steady-state of the vowel where the formant pattern is presumed to be static, continues to be widely used to represent vowels in an F1-F2 plane [for a review, see @kent-vorperian2018]. However, static estimates cannot capture how formants move as the signal unfolds; information that has been shown to influence listeners' vowel perception [e.g., @assmann-katz2005; @eklund1997; @hillenbrand-nearey1999; @kuronen2000; @nearey-assmann1986].

This paper investigates the acoustic characteristics of modern-day Swedish vowels in analyses that aim to contribute to our understanding of language-specific and language-general patterns of vowel acoustics. The paper presents a comprehensive description of the primary acoustic cues to vowel identity, using a recently released database of *h-VOWEL-d* (short: hVd) words, the SwehVd database [@persson-jaeger2023]. The variety investigated is Central Swedish, the regional standard variety of Swedish spoken in an area around and beyond Stockholm (eastern Svealand) [@bruce2009; @elert1994; @riad2014].^[For the reader unfamiliar with Central Swedish, Section \@ref(sec:sweVowels) provides an overview of the acoustics of Central Swedish vowel space.] Existing descriptions of the entire space of 21 vowels rest on recordings made more than 25 years ago [reported in, e.g., @engstrand1999; @kuronen2000; @leinonen2010; @riad2014]. Two of the most recent studies are @leinonen2010 and @kuronen2000 (Table \@ref(tab:previous-work)). The former is based on recordings obtained around 1999 of all vowels, of which four short vowels were omitted from analysis. It covers 98 rural locations in Sweden and Swedish-speaking parts of Finland, including reference talkers of Standard Swedish. The latter covers the entire vowel space but is based on recordings from 1981 [@leinonen1982]. More recent work over the last two decades has focused on parts of the phonological space, such as the long vowels for diphthongization studies [@pelzer-boersma2019], two vowels for merger studies [e.g., [`r linguisticsdown::cond_cmpl("ɵ")`] - [`r linguisticsdown::cond_cmpl("œ")`] in @wenner2010], allophonic variation in /`r linguisticsdown::cond_cmpl("ɛ")`/ [@gross2016], or a single allophone, e.g., the damped [`r linguisticsdown::cond_cmpl("ɨː")`] [@schotz2011], see Table \@ref(tab:previous-work). These studies all provide detailed mappings of different parts of the space, and contribute important insights into the current state of as well as ongoing processes. However, given their focus on subsets of the space, a comprehensive acoustic mapping of the modern-day Central Swedish vowel space *in its entirety* is lacking. Given that there is some evidence that productions of minimal pairs can lead to enhanced contrasts [e.g., @schertz2013; @seyfarth2016], how representative such subsets are for the vowel space as a whole, remains an open question. In addition, most previous studies differ in the materials used, in terms of the size of the database (e.g., number of talkers and repetitions per vowel), the demographics of talkers (e.g., male/female talkers, region of origin), and phonological contexts used for recording. For instance, the majority of previous work has either not held the phonetic context constant across vowels, or has investigated isolated vowel production out of context or in different CVC contexts (Table \@ref(tab:previous-work)). This diversity restricts comparison across studies on Swedish, as well as cross-linguistically.

\begin{landscape}
\begin{table}
\caption{\label{tab:previous-work}A selection of previous studies on Central Swedish vowels}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{2.5cm}>{\raggedright\arraybackslash}p{4.5cm}>{\raggedright\arraybackslash}p{4.5cm}>{\raggedright\arraybackslash}p{4.5cm}>{\raggedright\arraybackslash}p{4.5cm}}
\toprule
Article & Speech materials & Participants & Approach & Focus\\
\midrule
Eklund \& Traunmüller, 1997 & 3 repetitions of all 9 long vowels in isolation & 12 talkers (6 female) from the Greater Stockholm area, 20-58 years of age & Formant trajectories at 10 measurement points; F1-F2 means and SD; linear regression & Comparing the acoustics and perception of whispered and phonated vowels\\
\addlinespace
Elert, 1964 & 1 repetition of all 21 vowels in sentence lists and word list (word list recorded by 2 talkers only; different V:C and VC: contexts) & 11 talkers (5 female) from Stockholm, born in the 1930's & Duration means, SD and SE; t-statistics & Phonological quantity\\
\addlinespace
Eriksson, 2004 & 3-4 repetitions of all 21 vowels, different phonological contexts for each vowel & 12 talkers (6 female; 6 young) each from 107 locations across Sweden and Finland; 12 reference talkers (6 female; 6 young) of standard Swedish from the Greater Stockholm area & Project description & SweDia dialect database development\\
\addlinespace
Fant, Henningsson \& Stålhammar, 1969 & 1 repetition of all 9 long vowels in isolation & 24 male talkers, students at KTH in Stockholm & F1 to F4 and duration means & Formant frequencies of the long vowels\\
\addlinespace
Gross, Boyd, Leinonen \& Walker, 2016 & 3-15 repetitions of /`r linguisticsdown::cond_cmpl("ɛː")`/ before retroflex consonants or in other word contexts extracted from running speech (alongside corner vowel productions of [`r linguisticsdown::cond_cmpl("iː")`], [`r linguisticsdown::cond_cmpl("ɑː")`], [`r linguisticsdown::cond_cmpl("uː")`]) & 57 female and male talkers of 16-17 years of age (28 from Stockholm; 13 with foreign-born mother) & Euclidean distance; Wilcoxon rank sum test; t-test & Sociolinguistic variation in allophones to /`r linguisticsdown::cond_cmpl("ɛː")`/ in Gothenburg and Stockholm Swedish\\
\addlinespace
Kuronen, 2000 & 5-7 repetitions of all 21 vowels, different phonological contexts for each vowel and each repetition & 4 male talkers from Nyköping, 17-18 years of age (4 female reference talkers), recorded by Leinonen, Pitkänen \& Vihanta, 1982 & F0, F1 to F4 and duration means; formant trajectories at 4 measurement points with 30 ms intervals (long vowels) & Spectral and temporal acoustics of all Central Swedish vowels\\
\addlinespace
Leinonen, 2010 & a subset of 19 vowels from the SweDia database (see Eriksson, 2004 above) & see Eriksson, 2004 & Principal component analysis of Bark-filtered vowel spectra; multidimensional scaling for dialectometric analysis & Dialectal variation in Swedish vowel pronunciation\\
\addlinespace
Lindblom, 1963 & 5 repetitions of all 8 short vowels in bVb, dVd, gVg contexts, with four different stress patterns & 1 male talker from Stockholm, 19 years of age & F1 to F3 means, duration; formants as a function of duration and consonantal context & The effect of vowel duration on formant frequencies\\
\addlinespace
McAllister, Lubker \& Carlson, 1974 & 10 repetitions of all 6 long rounded vowels in itV context & 6 talkers of standard Swedish & EMG; F1 to F3 means & The articulation and acoustics of rounded vowels\\
\addlinespace
Pelzer \& Boersma, 2019 & 8 repetitions of all 9 long vowels, different phonological contexts for each vowel and each repetition & 8 talkers (4 female) from Stockholm & F1-F2 median values at 20, 50, 80\% into the vowel; linear mixed effects model & Diphthongization in the long vowels\\
\addlinespace
Schötz, Frid \& Löfqvist, 2011 & 6 repetitions of [`r linguisticsdown::cond_cmpl("ɨː")`] in two different contexts (bibel, papipa) & 1 male talker from Stockholm & Articulography; F1 to F4 means; Bark-circles & The articulation and acoustics of the damped [`r linguisticsdown::cond_cmpl("ɨː")`]\\
\addlinespace
Wenner, 2010 & 3 repetitions of [`r linguisticsdown::cond_cmpl("œ")`] and [`r linguisticsdown::cond_cmpl("ɵ")`] in different phonological contexts & 78 talkers (40 female) from 4 locations in Uppland, 12-85 years of age & F1 to F3 means; linear regression; correlation analysis & The merger of [`r linguisticsdown::cond_cmpl("œ")`] and [`r linguisticsdown::cond_cmpl("ɵ")`]\\
\bottomrule
\end{tabular}
\end{table}
\end{landscape}

```{r previous-work}
# Keep code for reproducibility
# Add table of previous work on Central Swedish vowels
# d.previous.work <- tibble(
#   Article = c("Eklund & Traunmüller, 1997",
#               "Elert, 1964",
#               "Eriksson, 2004",
#               "Fant, Henningsson & Stålhammar, 1969",
#               "Kuronen, 2000",
#               "Leinonen, 2010",
#               "Lindblom, 1963",
#               "McAllister, Lubker & Carlson, 1974",
#               "Pelzer & Boersma, 2019",
#               "Schötz, Frid & Löfqvist, 2011",
#               "Wenner, 2010"),
#   "Speech materials" = c("3 repetitions of all 9 long vowels in isolation",
#                          "1 repetition of all 21 vowels in sentence lists and word list (word list recorded by 2 talkers only; different V:C and VC: contexts)",
#                          "3-4 repetitions of all 21 vowels, different phonological contexts for each vowel",
#                          "1 repetition of all 9 long vowels in isolation",
#                          "5-7 repetitions of all 21 vowels, different phonological contexts for each vowel and each repetition",
#                          "a subset of 19 vowels from the SweDia database (see Eriksson, 2004 above)",
#                          "5 repetitions of all 8 short vowels in bVb, dVd, gVg contexts, with four different stress patterns",
#                          "10 repetitions of all 6 long rounded vowels in itV context",
#                          "8 repetitions of all 9 long vowels, different phonological contexts for each vowel and each repetition",
#                          "6 repetitions of the long /i:/ in two different contexts (bibel, papipa)",
#                          "3 repetitions of short /œ/ and /ɵ/ in different phonological contexts"),
#   Participants = c("12 talkers (6 female) from the Greater Stockholm area, 20-58 years of age",
#                    "11 talkers (5 female) from Stockholm, born in the 1930's",
#                    "12 talkers (6 female; 6 young) each from 107 locations across Sweden and Finland; 12 reference talkers (6 female; 6 young) of standard Swedish from the Greater Stockholm area",
#                    "24 male talkers, students at KTH in Stockholm",
#                    "4 male talkers from Nyköping, 17-18 years of age (4 female reference talkers), recorded by Leinonen, Pitkänen & Vihanta, 1982",
#                    "see Eriksson, 2004",
#                    "1 male talker from Stockholm, 19 years of age",
#                    "6 talkers of standard Swedish",
#                    "8 talkers (4 female) from Stockholm",
#                    "1 male talker from Stockholm",
#                    "78 talkers (40 female) from 4 locations in Uppland, 12-85 years of age"),
#   Approach = c("Formant trajectories at 10 measurement points; F1-F2 means and SD; linear regression",
#                "Duration means, SD and SE; t-statistics",
#                "Project description",
#                "F1 to F4 and duration means",
#                "F0, F1 to F4 and duration means; formant trajectories at 4 measurement points with 30 ms intervals (long vowels)",
#                "Principal component analysis of Bark-filtered vowel spectra; multidimensional scaling for dialectometric analysis",
#                "F1 to F3 means, duration; formants as a function of duration and consonsantal context",
#                "EMG; F1 to F3 means",
#                "F1-F2 median values at 20, 50, 80% into the vowel; linear mixed effects model",
#                "Articulography; F1 to F4 means; Bark-circles",
#                "F1 to F3 means; linear regression; correlation analysis"),
#   Focus = c("Comparing the acoustics and perception of whispered and phonated vowels",
#             "Phonological quantity",
#             "SweDia dialect database development",
#             "Formant frequencies of the long vowels",
#             "Spectral and temporal acoustics of all Central Swedish vowels",
#             "Dialectal variation in Swedish vowel pronunciation",
#             "The effect of vowel duration on formant frequencies",
#             "The articulation and acoustics of rounded vowels",
#             "Diphthongization in the long vowels",
#             "The articulation and acoustics of the damped /i:/",
#             "The merger of short /œ/ and /ɵ/"))
# 
# kable(d.previous.work,
#       format = "latex",
#       booktabs = TRUE,
#       caption = "A selection of previous studies on Central Swedish vowels") %>%
#   kable_styling(
#     font_size = 7) %>%
#   column_spec(1, width = "2.5cm") %>%
#   column_spec(2:5, width = "4.5cm")
```

The materials and methodological approach adopted in the current paper is motivated by the goal to complement previous work for a comprehensive picture of modern-day Central Swedish vowels. The paper provides an up-to-date acoustic description of the entire vowel space of 21 categories, using the SwehVd database [@persson-jaeger2023]. The hVd context continues to be widely used in vowel production and perception studies on languages where the glottal /h/ in onset minimizes supraglottal articulations and thereby reduces the risk of coarticulatory effects from the surrounding phonetic context, as in e.g., English and Swedish [as confirmed in e.g., @chesworth2003; @robb-chen2009]. The use of an hVd database hence increases comparability to studies on other languages [e.g., @hillenbrand1995; @peterson-barney1952]. The main spectral (F1-F2-F3) and temporal cues to vowel identity are reported in static analyses [following e.g., @engstrand1999; @fant1969], as well as dynamic analyses, given the well documented importance of formant dynamics on vowel production and perception [e.g., @assmann-katz2005; @eklund1997; @hillenbrand-nearey1999; @kuronen2000; @nearey-assmann1986]. While fundamental frequency (F0) is not considered an important cue to vowel identity in itself, it is known to vary between languages, dialects and speech styles and is therefore reported in the static analysis for a comprehensive picture of the acoustics [e.g., @henton2005; @jacewicz-fox2018; @leung2016; @johnson2005; @mennen2012; @weirich2019].

The static analysis assesses what cues contribute to vowel distinctions and evaluates some of the claims introduced in previous work, such as the hypothesized importance of F3 for rounded vs. unrounded high front contrasts [@fant1959; @fant1969; @fujimura1967; @kuronen2000; @persson-jaeger2024], and to what extent spectral and temporal cues contribute to long-short vowel pair distinctions [e.g., @behne-kirk1997; @kuronen2000]. The dynamic analysis explores what part of the space seems more prone to diphthongization, and investigates how formant dynamics contribute to vowel distinctions. In contrast with previous work investigating the dynamics of Central Swedish vowels, the present study includes both long and short vowels, thus submitting the entire vowel space to the same analyses.

The paper is organized as follows. A background to the acoustics of Central Swedish vowels is provided by a review of previous work. This is followed by methods and results, and finally, a discussion of the results and its consequences for the Central Swedish vowel system. 
All analyses and visualization code for this study can be found in an online repository (<https://osf.io/7uvj4/>). This article is written in R Markdown, which allows readers to easily replicate the analyses using freely available software [@r-core; @r-studio].

```{r load-SwehVd}
# Load native Swedish vowel data, manually corrected (generated by Persson-2023-outlierCorrected)
d.SwehVd <-
  read_csv('../../data/phonetic vowel statistics/Swedish/Published databases/Persson-2023/outlier-corrected-vowel-data/Persson_2023_L1_vowels_wDistrOutliers.csv') %>%
  mutate(
    Database = "SwehVd")

# What proportion of the most extreme values should be considered outliers? 
# (if set to e.g., .05 that means that points with cumulative densities below
# .025 or above .975 are considered outliers)
outlier_probability_cutoff = .05

# To be conservative, remove all outliers outside of 0.25th to the 97.5th quantile for each category and talker
d.SwehVd %<>%
  obtain_densities() %>%
  filter(!is_outlier(cumulative_probability_F1F2)) %>%
  select(-c(cumulative_probability_F1F2, mean_F1F2, cov_F1F2))
```
```{r}
# Make temp exclusions file for identifying no of talkers to exclude
d.SwehVd.exclusions <-
  d.SwehVd %>%
  filter(Word != "hädd") %>%
  select(c(Talker, Gender, category, Transcribed_vowel, Token)) %>%
  distinct() %>%
  group_by(Talker, Gender, category) %>%
  summarise(
    N_tokens_per_category = n_distinct(Token),
    Transcribed_vowel = Transcribed_vowel) %>%
  filter(Transcribed_vowel != "targeted") %>%
  group_by(Talker, Gender, category, N_tokens_per_category) %>%
  summarise(
    N_unidentifiable_vowels = length(Transcribed_vowel)) %>%
  group_by(Talker, category, Gender) %>%
  mutate(
    exclude_Talker = case_when(N_tokens_per_category < 6 & N_unidentifiable_vowels > 2 ~ "TRUE",
                               N_tokens_per_category >= 10 & N_unidentifiable_vowels > 7 ~ "TRUE",
                               TRUE ~ "FALSE")) %>%
  filter(exclude_Talker == TRUE)
```

```{r filter-data-for-study}
# Exclude talkers that failed to produce *hodd* altogether + the mispronounced words by remaining talkers. This approach results in exclusion of an additional two talkers, given that they only did five recordings for each vowel. Also exclude measurements at 20 and 80% into the vowel, and all /hädd/ words since they are a duplicate of "[ɛ]" - the short allophone to /e/ neutralizes with the short allophone to /ɛ/. Also exclude all NAs in F0s.
d.SwehVd.forStudy <-
  d.SwehVd %>%
  filter(!Talker %in% d.SwehVd.exclusions$Talker, Transcribed_vowel == "targeted", Word != "hädd", !is.na(F0), Unreliable_measurement == FALSE) %>%
  select(-Transcribed_vowel) %>%
  rename(timepoint = Location) %>%
  group_by(Talker, Age, Gender, category, Word, Token, Trial, timepoint, Quantity, Database) %>%
  summarise(across(c(F0, F1, F2, F3, Duration), ~ geometric.mean(.x))) %>%
  ungroup()
```

```{r normalize-data}
# Normalize all data based on the respective training of each cross-validation group
d.SwehVd.forStudy %<>%
  #Add fold_type in order for norm function to work
  mutate(fold_type = "training") %>%
  group_map(
    .f = ~ apply_all_transformations_and_normalization(
      data = .x,
      normalize_based_on_fold_types = "training"),
    .keep = T) %>%
  reduce(bind_rows) %>%
  ungroup()

# Pivot data to long format for plotting and calculation of separability index
d.SwehVd.forStudy.long <-
  d.SwehVd.forStudy %>%
  select(-starts_with("formants")) %>%
  pivot_longer(
    cols = starts_with("F", ignore.case = FALSE),
    names_to = c("Cue", "Normalization.Scale", "Normalization.Type"),
    names_sep = "_",
    values_to = "Cue.Value") %>%
  pivot_wider(
    names_from = "Cue",
    values_from = "Cue.Value") %>%
  # Mutate both
  mutate(
    Normalization.Type = paste(Normalization.Type, Normalization.Scale, sep = "_")) %>%
  mutate(
    Normalization.Type = factor(plyr::mapvalues(Normalization.Type, levels.normalization, labels.normalization), levels = labels.normalization, ordered = T),
    Duration = ifelse(Normalization.Type %in% c("C-CuRE (Hz)", "C-CuRE (Mel)", "C-CuRE (ERB)", "C-CuRE (Bark)", "C-CuRE (semitones)"), Duration_CCuRE, Duration)) %>%
   select(-c(Duration_CCuRE, Normalization.Scale)) %>%
   relocate(Talker, Age, Gender, Normalization.Type, fold_type, category, Quantity, Token)

d.SwehVd.forStudy.long.static <- d.SwehVd.forStudy.long %>%
  filter(Normalization.Type %in% c("no normalization (Hz)", "Nearey's uniform scaling (log)"), timepoint %in% c(35, 50, 65)) %>%
  # Get the  mean F1-F2 across the five time points
  group_by(Normalization.Type, Talker, Gender, category, Token, Word, Quantity) %>%
  summarise(across(c(F0, F1, F2, F3, Duration), ~ mean(.x))) %>%
  ungroup()

d.SwehVd.forStudy.long.dynamic <- d.SwehVd.forStudy.long %>%
  filter(Normalization.Type %in% c("no normalization (Hz)", "Nearey's uniform scaling (log)"))
```

## The acoustics of Central Swedish vowels {#sec:sweVowels}
This section provides a description of the overall inventory of Central Swedish monophthongs, and discusses the role of cues beyond F1 and F2. It furthermore presents a review of previous studies on diphthongization and formant dynamics.

Central Swedish is most often described as having nine vowel phonemes: /`r linguisticsdown::cond_cmpl("i")`/, /`r linguisticsdown::cond_cmpl("y")`/, /`r linguisticsdown::cond_cmpl("ʉ")`/, /`r linguisticsdown::cond_cmpl("e")`/, /`r linguisticsdown::cond_cmpl("ɛ")`/, /`r linguisticsdown::cond_cmpl("ø")`/, /`r linguisticsdown::cond_cmpl("ɑ")`/, /`r linguisticsdown::cond_cmpl("o")`/, /`r linguisticsdown::cond_cmpl("u")`/. The long allophones are [`r linguisticsdown::cond_cmpl("iː")`], [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("ʉː")`], [`r linguisticsdown::cond_cmpl("eː")`], [`r linguisticsdown::cond_cmpl("ɛː")`], [`r linguisticsdown::cond_cmpl("øː")`], [`r linguisticsdown::cond_cmpl("ɑː")`], [`r linguisticsdown::cond_cmpl("oː")`], [`r linguisticsdown::cond_cmpl("uː")`], and the short allophones are [`r linguisticsdown::cond_cmpl("ɪ")`], [`r linguisticsdown::cond_cmpl("ʏ")`], [`r linguisticsdown::cond_cmpl("ɵ")`], [`r linguisticsdown::cond_cmpl("ɛ")`], [`r linguisticsdown::cond_cmpl("ø")`], [`r linguisticsdown::cond_cmpl("a")`], [`r linguisticsdown::cond_cmpl("ɔ")`], [`r linguisticsdown::cond_cmpl("ʊ")`]. The short allophones of /`r linguisticsdown::cond_cmpl("e")`/ and /`r linguisticsdown::cond_cmpl("ɛ")`/ has been reported to neutralize as [`r linguisticsdown::cond_cmpl("ɛ")`] in Central Swedish, resulting in 17 vowels, rather than 18 [@riad2014]. There is also evidence of neutralization of the short /`r linguisticsdown::cond_cmpl("ø")`/ and /`r linguisticsdown::cond_cmpl("ʉ")`/ as [`r linguisticsdown::cond_cmpl("ɵ")`] among some talkers, primarily in position before a retroflex [@stahle1965; @wenner2010]. In addition to these 17 vowels, there are 4 additional long and short allophones---[`r linguisticsdown::cond_cmpl("æː")`], [`r linguisticsdown::cond_cmpl("æ")`], [`r linguisticsdown::cond_cmpl("œː")`], and [`r linguisticsdown::cond_cmpl("œ")`], as /`r linguisticsdown::cond_cmpl("ɛ")`/ and /`r linguisticsdown::cond_cmpl("ø")`/ lower in position before /r/ or any retroflex segment [e.g., @kuronen2000; @riad2014]. Traditionally, Central Swedish has been described using four height levels and three backness levels [@riad2014].

It has furthermore been suggested that Central Swedish is defined by three levels of lip-rounding, where the rounded vowels are most often referred to as either inrounded, with an extreme narrowing of the lips---[`r linguisticsdown::cond_cmpl("ʉː")`] and [`r linguisticsdown::cond_cmpl("uː")`], or outrounded, with a lesser degree of lip-narrowing and more protruded lips---[`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("øː")`], [`r linguisticsdown::cond_cmpl("œː")`], [`r linguisticsdown::cond_cmpl("oː")`], and the remaining vowels defined as unrounded [e.g., @fant1971; @mcallister1974]<!--add: for a critique on the no of levels fo rounding, see??-->. Previous work has claimed that lip-rounding is particularly important for some vowel distinctions. For instance, [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] have been described as overlapping in F1-F2 space, but as more separable when F3 is considered [@fant1959; @fant1969; @fujimura1967; @kuronen2000].

The vowels in each pair have been reported to differ systematically in duration, with short-long vowel to vowel ratios on average .65-.67 for Central Swedish [@elert1964; @kuronen2000; @strangert2001]. Spectral differences have traditionally been interpreted as a consequence of the durational distinction, hence assuming a trading relationship between spectral and temporal cues [for a review, see @schaeffler2005]. It has been hypothesized that most of the durational variation is carried by F2 [e.g., @kuronen2000; @lindblom1963]. Previous work has found the largest spectral differences for the [`r linguisticsdown::cond_cmpl("ʉː")`] - [`r linguisticsdown::cond_cmpl("ɵ")`], and [`r linguisticsdown::cond_cmpl("ɑː")`] - [`r linguisticsdown::cond_cmpl("a")`] vowel pairs, and the smallest differences for [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`], and [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("ø")`] [e.g., @kuronen2000]. For pairs with small spectral differences, duration is presumably more important for vowel distinction. Perceptual studies on synthesized speech from talkers of Stockholm Swedish have confirmed that duration is the primary cue for [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("ɪ")`], and [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("ɔ")`] [@behne-kirk1997; for results on Southern Swedish and additional vowel pairs, [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`], [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("ø")`], see @haddingkoch1964]. The extent to which *all* long-short vowel pairs rely on spectral cues is less known, as studies have focused on subsets of pairs.

According to previous work, several of the long vowels in Central Swedish tend to diphthongize in their phonetic realization. Diphthongization is considered prosodically conditioned and is the strongest in stressed vowels [@bleckert1987; @leinonen2010].^[In general, true phonological diphthongs are not considered part of the phonological inventory of Central Swedish [@eliasson2022].] Previous studies have characterized the diphthongal glide in the later part of the long vowels as either a centralization of the vowel segment towards [`r linguisticsdown::cond_cmpl("ə")`] or a more open quality, or as a consonantal offglide [e.g., @elert1981; @elert2000; @fant1969; @fant1971; @kuronen2000; @mcallister1974; @pelzer-boersma2019; @riad2014]. Results are inconclusive as to how widespread diphthongization is across the vowel space, and what direction it takes. Most work has however found substantial diphthongization towards a more open quality for the mid and mid-high vowels [`r linguisticsdown::cond_cmpl("eː")`], [`r linguisticsdown::cond_cmpl("øː")`] and [`r linguisticsdown::cond_cmpl("oː")`] [@eklund1997; @elert2000; @fant1969; @pelzer-boersma2019]. In addition, diphthongization has been hypothesized to cue vowel distinctions for certain high vowels ([`r linguisticsdown::cond_cmpl("iː")`], [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("ʉː")`], and [`r linguisticsdown::cond_cmpl("uː")`]) [e.g., @fant1971; @kuronen2000]. For instance, @kuronen2000 reported that [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("eː")`], and [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("oː")`], differed in formant patterns only at later time-points of the vowel for some talkers and that the contrast between [`r linguisticsdown::cond_cmpl("ɛː")`] and [`r linguisticsdown::cond_cmpl("æː")`] was maintained solely by trajectory movements. Of importance for the present study, less is known about the formant dynamics in the short vowels, given the almost exclusive focus on the long vowels in diphthongization studies.

Some talkers of Central Swedish have been reported to realize [`r linguisticsdown::cond_cmpl("iː")`], [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("ʉː")`] and [`r linguisticsdown::cond_cmpl("uː")`] with a consonantal offglide, where the end-point of [`r linguisticsdown::cond_cmpl("iː")`] is described as a palatal approximant [`r linguisticsdown::cond_cmpl("j")`], the end-point of [`r linguisticsdown::cond_cmpl("yː")`] a voiced labio-palatal approximant [`r linguisticsdown::cond_cmpl("ɥ")`], the end-point of [`r linguisticsdown::cond_cmpl("ʉː")`] and [`r linguisticsdown::cond_cmpl("uː")`] a voiced bilabial fricative [`r linguisticsdown::cond_cmpl("β")`] [@elert1980; @hammarstrom-norman1957; @mcallister1974]. Furthermore, both [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] can be damped and produced with a buzzing sound, phonetically realized as [`r linguisticsdown::cond_cmpl("ɨː")`]. The buzzing sound is presumably generated by the co-articulation of the vowel and a voiced fricative sound similar to [z] [@elert1980; @engstrand2000]. The damped [`r linguisticsdown::cond_cmpl("ɨː")`] has been found in several dialects across Sweden, both in rural areas and in the cities of Gothenburg and Stockholm [@bjorsten-engstrand1999; @elert1980; @engstrand2000; @gross2020; @riad2014]. It has been claimed to carry strong socio-indexical meaning across locations; indexing place in rural areas, and class and gender in urban areas [e.g., @bruce2010; @gross2018; @kotsinas1994; @nilsson2021]. In work on Swedish dialectology, it is often referred to as the Viby-*i*, and in the Stockholm area, as the Lidingö-*i*. Acoustically, it manifests primarily as a lowering of F2, thus occupying a more centralized position in the F1-F2 space. @schotz2011 describe it as a central palatal vowel, as the articulatory correlates involve a retracted and lower tongue position, the tip of the tongue being higher than blade and dorsum.

The methodology employed is presented next, beginning with a description of the materials used.

# Methods
## Materials {#sec:swehVd}
The materials used is a corpus of Swedish hVd word recordings, collected by Anna Persson and Maryann Tan (Stockholm University) in 2020-2024, the SwehVd. An initial version of the corpus with 24 female talkers is described in @persson-jaeger2023. For this paper, the final release is presented, including 24 additional male talkers. All recordings, annotations, and acoustic measurements are available at <https://osf.io/ruxnb/>. 
SwehVd covers the entire monophthong inventory of Central Swedish, including all nine long vowels, eight short vowels, and the four allophones to /`r linguisticsdown::cond_cmpl("ɛ")`/ and /`r linguisticsdown::cond_cmpl("ø")`/.^[The words used to elicit the 21 vowels were: *hid*-[`r linguisticsdown::cond_cmpl("iː")`], *hyd*-[`r linguisticsdown::cond_cmpl("yː")`], *hud*-[`r linguisticsdown::cond_cmpl("ʉː")`], *hed*-[`r linguisticsdown::cond_cmpl("eː")`], *häd*-[`r linguisticsdown::cond_cmpl("ɛː")`], *höd*-[`r linguisticsdown::cond_cmpl("øː")`], *had*-[`r linguisticsdown::cond_cmpl("ɑː")`], *håd*-[`r linguisticsdown::cond_cmpl("oː")`], *hod*-[`r linguisticsdown::cond_cmpl("uː")`], *hidd*-[`r linguisticsdown::cond_cmpl("ɪ")`], *hydd*-[`r linguisticsdown::cond_cmpl("ʏ")`], *hudd*-[`r linguisticsdown::cond_cmpl("ɵ")`], *hedd*-[`r linguisticsdown::cond_cmpl("ɛ")`], *hädd*-[`r linguisticsdown::cond_cmpl("ɛ")`], *hödd*-[`r linguisticsdown::cond_cmpl("ø")`], *hadd*-[`r linguisticsdown::cond_cmpl("a")`], *hådd*-[`r linguisticsdown::cond_cmpl("ɔ")`], *hodd*-[`r linguisticsdown::cond_cmpl("ʊ")`], *härd*-[`r linguisticsdown::cond_cmpl("æː")`], *härr*-[`r linguisticsdown::cond_cmpl("æ")`], *hörd*-[`r linguisticsdown::cond_cmpl("œː")`], *hörr*-[`r linguisticsdown::cond_cmpl("œ")`]. The mix of 4 real Swedish words -- *hed*, *härd*, *hörd*, *hud* (English translations: *heath*, *hearth*, *heard* and *skin*, respectively), and 18 phonotactically legal pseudowords in the word list, might have affected talkers' pronunciations. For instance, there are studies indicating frequency and neighborhood density effects on vowel productions, with low-frequency words and words with high neighborhood density being produced more distinctly [e.g., @munson-solomon2004; @wright2004]. Similar effects of hyperarticulation interacting with neighborhood density have been found for pseudowords as well, however, with substantial cross-talker variability [e.g., @scarborough2012].] SwehVd focuses on a single regional variety, providing high resolution within and across talkers for this variety with 10 recordings of each hVd word from each of the `r n_distinct(d.SwehVd$Talker)` talkers (N = `r nrow(d.SwehVd %>% filter(Gender == "female") %>% distinct(Talker))` female), for a total N of tokens = `r nrow(d.SwehVd %>% distinct(Talker, category, Token))`. All talkers in the database were L1 talkers of Swedish, born and raised in the Greater Stockholm area or surroundings, of 18-44 years of age (mean age = `r round(mean(d.SwehVd$Age, na.rm = T), digits = 0) %>% round(digits = 0)`; SD = `r sd(d.SwehVd$Age, na.rm = T) %>% round(digits = 2)`). For more details on the recruitment, recording, pre-processing, segmentation and annotation procedure, see @persson-jaeger2023.

For the vast majority of talkers in the SwehVd, *hädd* productions elicited the same vowel as *hedd* (see Supplementary Information---SI, Figure \@ref(fig:SI-hedd)), which confirms the commonly held assumption that the short allophone of /e/ neutralizes with the short allophone of /`r linguisticsdown::cond_cmpl("ɛ")`/ in Central Swedish. In order to have a balanced number of tokens for each vowel, all *hädd* words were excluded from the subsetted SwehVd materials used in this study [following @persson-jaeger2023]. Recordings on which the talker did not produce the targeted vowel were also excluded.^[The SwehVd database contains information on both targeted vowel and what vowel was actually produced.] Furthermore, outliers were identified and removed by estimating the relative probability of each token's F1-F2 values given the joint distribution of F1-F2 for that vowel and talker. Tokens outside of the `r 100 * (outlier_probability_cutoff/2)`th to `r 100 * (1 - outlier_probability_cutoff/2)`th quantile of the bivariate Gaussian distribution were filtered out. To facilitate empirical analyses and statistical models, all talkers (N = `r n_distinct(d.SwehVd.exclusions$Talker)`) with fewer than 4 remaining recordings for at least one of the vowels were removed. This left data from `r n_distinct(d.SwehVd.forStudy$Talker)` L1 talkers (N=`r (d.SwehVd.forStudy %>% filter(Gender == "female") %>% summarise(n_distinct(Talker)) %>% pull())` female talkers), with on average `r d.SwehVd.forStudy %>% filter(timepoint == 50) %>% group_by(category) %>% tally() %>% summarise(x = mean(n)) %>% pull() %>% round(digits = 0)` (SD = `r d.SwehVd.forStudy %>% filter(timepoint == 50) %>% group_by(category) %>% tally() %>% summarise(x = sd(n)) %>% pull() %>% round(digits = 1)`) tokens per vowel (range = `r d.SwehVd.forStudy %>% filter(timepoint == 50) %>% group_by(category) %>% tally() %>% summarise(x = min(n)) %>% pull() %>% round(digits = 0)` to `r d.SwehVd.forStudy %>% filter(timepoint == 50) %>% group_by(category) %>% tally() %>% summarise(x = max(n)) %>% pull() %>% round(digits = 0)`), for a total of `r nrow(d.SwehVd.forStudy %>% filter(timepoint == 50))` observations. 

## Acoustic analyses
### Measuring acoustic cues to vowel identity {#sec:cueMeasures}
The Swedish version of the Montreal Forced Aligner developed by @young2021 was used to obtain estimates of word and segment boundaries. The boundaries were then manually corrected by the author (an L1-talker of Swedish). The formant analysis was carried out in Praat [@boersma-weenink2022], using the Burg algorithm to extract estimates of the first three formants (F1-F3) at five time-points of the vowel (20, 35, 50, 65, 80% into the vowel). The five points were selected to capture formant trajectories and potential diphthongization in the later time-points for the dynamic analysis [following, e.g., @holbrook-fairbanks1962; @jacewicz2011; @kuronen2000; @lehiste-peterson1961; @yang2019], as well as provide stable measures of the steady-state of the vowel for the static analysis.<!--@pelzer-boersma2019 did 20,50,80; kuronen 4 points with 30 ms in between, @holbrook-fairbanks1962; @lehiste-peterson1961 five measurement points, six time-points @yang2019--> The Burg algorithm was parameterized with a time step of 0.01 seconds, a window length of 0.025 seconds, and pre-emphasis was applied from 50 Hz. The maximum number of formants was set to 5, with a formant ceiling of 5500 Hz for the female talkers, and 5000 Hz for the male talkers. Vowel duration and F0 was extracted across the entire vowel segment. The Praat script that extracts these cues is shared as part of the SwehVd OSF repository, allowing researchers to choose additional or alternative time points at which to extract formants and F0.

To correct for measurement errors in the automatic extraction of cues, 5 separate univariate distributions of the five extracted cues (F0, F1, F2, F3 and duration) was estimated for each distinct combination of talker and vowel. Points that fell outside of the 2.50th to the 97.50th quantile of the distributions for each vowel were identified, examined for measurement errors, and subsequently corrected. This followed the approach employed for the SwehVd corpus [@persson-jaeger2023], and strikes a middle-ground between the ideal (manual correction of all tokens) and feasibility.

### Vowel normalization
The raw formant values were transformed into a vowel normalized space using Nearey's uniform scaling account [@nearey1978]. Formant measurements in Hertz are reported in the SI, Section \@ref(sec:SI-raw). Vowel normalization is used in studies on vowel production and perception to account for acoustically irrelevant cross-talker variation, as caused by differences in anatomical structure, e.g., vocal tract size [for reviews see e.g., @barreda-nearey2018; @johnson-sjerps2021; @stilp2020]. In vowel production studies such as the present, normalization is primarily used as a methodological tool. Transforming the formant data into a normalized space reduces differences in F1 and F2 due to physiology, which can reduce between-talker variability and increase category separability, as visualized in Figure \@ref(fig:swe-vowels) (compare left and right panel). 

Previous work on Swedish has primarily analyzed vowel data in raw Hertz [@bjorsten-engstrand1999; @fant1969; @pelzer-boersma2019], or transformed into Bark [@fant1983; @kuronen2000; @schotz2011; @wenner2010], Mel [@lindblom1963], or Lobanov [@gross2020]. The choice of Nearey's uniform scaling in the present study was motivated by its previous use in socio-phonetic research to describe and compare languages and varieties [e.g., @barreda2021; @labov2001; @labov-boberg2005], and by its plausibility as perceptual model of how we come to achieve robust cross-talker perception, as it has provided a good fit against both production [e.g., @persson-jaeger2023; @syrdal1985] and perception data [e.g., @barreda2021; @persson2024].

(ref:swe-vowels) The SwehVd vowel data in unnormalized Hertz (*left*) and Nearey's uniform scaling space (*right*), along the first two formants, F1 and F2. Points show recordings of each of the 21 Central Swedish vowels by 44 (24 female) L1 talkers in the database, averaged across the three middle time-points (at 35, 50, 65% into the vowel). Vowel labels are placed at the vowel mean across talkers. Long vowels are boldfaced. Vowel recordings on which the talker produced a different vowel than the intended are excluded (`r signif((d.SwehVd %>% filter(Transcribed_vowel != "targeted") %>% nrow() / d.SwehVd %>% nrow()) * 100)`% of all recordings).

```{r swe-vowels, fig.width=base.width*3.5, fig.height=base.height*2, fig.align='center', fig.pos="ht", fig.cap="(ref:swe-vowels)"}
p <- d.SwehVd.forStudy.long.static %>%
  ggplot(
    aes(
      x = F2,
      y = F1)) +
  geom_point(
    aes(
      colour = category,
      shape = Gender),
    alpha = .4) +
  # Add between-talker mean
  geom_label(
    data =
      ~ .x %>%
      group_by(Normalization.Type, category, Quantity) %>%
      summarise(across(c(F1, F2), ~ mean(.x))),
    mapping = aes(
      colour = category,
      label = category,
      fontface = ifelse(category %in% levels.vowel.IPA.swe.long, 2, 1)),
    alpha = .8,
    size = 4,
    label.size = NA,
    label.padding = unit(.06, "cm")) +
  scale_colour_manual(name = "category", values = colors.vowel.swe) +
  scale_x_reverse("F2", position = "top", breaks = scales::breaks_pretty(6)) +
  scale_y_reverse("F1", position = "right", breaks = scales::breaks_pretty(6)) +
  guides(color = "none") +
  facet_wrap(~ Normalization.Type, scales = "free") +
  myGplot.defaults(base_size+2)  +
  theme(legend.position = "top")
p
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

### Static acoustic analysis {#sec:method-static}
The static analysis of SwehVd presents formant measurements at the steady state of the vowel, by averaging across the three mid-points.^[The choice of time-point for extracting formants, or whether to average across several time-points, affects the acoustic characterizations given how formants move across the vowel segment. The SI (\@ref(sec:SI-measurement-points)) presents evaluations of the effect of different measurement points.] It maps the entire vowel space of 21 categories and evaluates the relative contribution of F0, F1, F2, F3 and duration to vowel distinctions, using visualizations of cues and cue correlations.

In order to evaluate the hypothesized importance of lip-rounding (F3) for neighboring unrounded and rounded categories, a category separability index was employed. Category separability index and similar measures of reduction in variance or distance between means continue to be frequently used in phonetic research [see e.g., @nycz2013 for a review; @fabricius2009; @flynn-foulkes2011; @labov2010]. While the separability index is a simple and straightforward measure of the relative separability of vowel categories, it nevertheless comes with certain limitations to which I return in the General discussion (\@ref(sec:discussion)). Following work by @wedel2018 and @xie-jaeger2020, each vowel's separability from the neighboring vowel was calculated as the average distance of vowel tokens to the centroid of the neighboring vowel, operationalized as \@ref(eq:category-separability). 

\begin{equation}
\footnotesize
 separability \ of /`r linguisticsdown::cond_cmpl("yː")`/ from /`r linguisticsdown::cond_cmpl("iː")`/ = \frac{\sum\limits_{k=1}^{n} \sqrt{(F1_{token \ k \ of /`r linguisticsdown::cond_cmpl("yː")`/} - F1_{Center \ of /`r linguisticsdown::cond_cmpl("iː")`/})^2 + (F2_{token \ k \ of /`r linguisticsdown::cond_cmpl("yː")`/} - F2_{Center \ of /`r linguisticsdown::cond_cmpl("iː")`/})^2}}{n} (\#eq:category-separability)
\end{equation}

For instance, for the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] contrast, first, each talker's [`r linguisticsdown::cond_cmpl("iː")`] center was calculated for F1-F2. Next, the distances between each [`r linguisticsdown::cond_cmpl("yː")`] token to the neighboring [`r linguisticsdown::cond_cmpl("iː")`] center from the same talker were calculated for F1-F2. Finally, the distances were averaged across all [`r linguisticsdown::cond_cmpl("yː")`] tokens from a talker, resulting in a separability measure for that vowel and talker. The same was done in the opposite direction for the same contrast, thus the calculating the separability of [`r linguisticsdown::cond_cmpl("iː")`] tokens from the [`r linguisticsdown::cond_cmpl("yː")`] center, following @xie-jaeger2020. The separability index reports the average separability across the two categories in each contrast. The higher the index, the greater the separation between categories. The same was subsequently done for F1-F2-F3. These two measures of separability for each contrast (F1-F2, F1-F2-F3) were then compared to assess whether including F3 would lead to increased category separability. The contrasts investigated were [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("eː")`] - [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] for comparing unrounded vs. outrounded vowels, and [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`], [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("uː")`], [`r linguisticsdown::cond_cmpl("ɔ")`] - [`r linguisticsdown::cond_cmpl("ʊ")`] for outrounded vs. inrounded vowels.^[I note that this way of calculating category separability assumes talker-specific category representations. The SI \@ref(sec:SI-separability-talkerIndep) reports separability indices that instead assume talker-independent representations.]

To quantify the effect of including F3 on category separability, separate linear mixed-effects models (LMM) were fit for each contrast, predicting separability from cue combination (F1-F2-F3 vs. F1-F2) while including by talker random intercepts.^[By-talker random intercepts was the maximum random effect structure that converged.] The model was formulated as follows: $separability \sim cue combination + (1|Talker)$. Cue combination was treatment-coded with F1-F2 as reference category, thus comparing F1-F2-F3 against the F1-F2 baseline.

The same process was applied to investigate to what extent long-short vowel pairs differ in spectral and temporal cues, by assessing what combination of cues would provide the largest separability between the two vowels in each pair. For this evaluation of quantity contrasts, the category separability index was calculated for each pair and three different cue combinations: F1-F2, F1-F2-F3, or F1-F2-duration. The models were the same as the previous sets, with F1-F2 as reference category, comparing each cue combination against the F1-F2 baseline.

The results of the static analysis are presented in Section \@ref(sec:static).

### Dynamic acoustic analysis {#sec:method-dynamic}
Formant measurements at all five time-points were used in the dynamic analysis to assess the importance of formant dynamics for vowel distinctions. The dynamic analysis is divided into two main sections. In the first section, formant trajectory plots were used to assess the scope and direction of formant movements, to what extent vowels seemed to diphthongize, and to evaluate the hypothesized importance of formant trajectories for the [`r linguisticsdown::cond_cmpl("iː")`]-[`r linguisticsdown::cond_cmpl("yː")`]-[`r linguisticsdown::cond_cmpl("eː")`], [`r linguisticsdown::cond_cmpl("oː")`]-[`r linguisticsdown::cond_cmpl("uː")`] and [`r linguisticsdown::cond_cmpl("ɛː")`]-[`r linguisticsdown::cond_cmpl("æː")`] contrasts reported in previous work [e.g., @kuronen2000; @pelzer-boersma2019]. Lastly, trajectories of short vowels were also visualized as they have not been typically explored in the past.

In the second part of the dynamic analysis, the hypothesized contribution of formant dynamics to category information was modeled using generalized additive mixed-effects models (GAMMs) [@baayen2017]. GAMMs were employed to assess what cues carry information about vowel quality once formant dynamics were inspected. GAMMs are increasingly used in phonetic research, due to their suitability in modeling the non-monotonic complex phonetic patterns found in formants without assuming linearity or having to rely on the simplifying assumption that vowels can be reduced to a single F1-F2 point estimate [e.g., @chuang2021; @soskuthy2021; @wieling2018]. GAMMs have been used in studies on vowels in different English varieties, e.g., on /u/-fronting in Derby English [@soskuthy2018] and on the front vowel system of Southern American English [@renwick-stanley2020] but to the best of my knowledge, they have not been implemented in studies of Swedish vowels. The use of GAMMs thus complements previous work on Central Swedish that has primarily used visual inspection, formant measurements and linear models (Table \@ref(tab:previous-work)).

Two main groups of GAMMs were fit in the dynamic analysis. In the first group, GAMMs were fit to 6 subsets of neighboring contrasts, hypothesized to differ primarily in formant dynamics: [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`], [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("eː")`], [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("uː")`], [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`] [@fant1971; @kuronen2000; @pelzer-boersma2019]. Given the directionality in formant trajectories found for [`r linguisticsdown::cond_cmpl("øː")`]-[`r linguisticsdown::cond_cmpl("œː")`] (Figure \@ref(fig:trajectories)), this contrast was also included. To explore potential effects of dynamics in the corresponding short vowels, an additional 4 contrasts were modeled. These were not entirely identical to the long subsets, for reasons of evident separability in F1-F2 space: [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], [`r linguisticsdown::cond_cmpl("ɔ")`] - [`r linguisticsdown::cond_cmpl("ʊ")`], [`r linguisticsdown::cond_cmpl("ɛ")`] - [`r linguisticsdown::cond_cmpl("æ")`] and [`r linguisticsdown::cond_cmpl("ø")`]-[`r linguisticsdown::cond_cmpl("œ")`]. The general model formulation employed ordered factor difference smooths as follows: $formant \sim category + Gender + s(timepoint) + s(timepoint, by = category, k = 5) + s(Talker, bs = "re") + s(Talker, category, bs = "re")$. The ordered factor predictor (= category) was treatment coded with [`r linguisticsdown::cond_cmpl("iː")`], [`r linguisticsdown::cond_cmpl("oː")`], [`r linguisticsdown::cond_cmpl("ɛː")`], [`r linguisticsdown::cond_cmpl("øː")`], [`r linguisticsdown::cond_cmpl("ɪ")`], [`r linguisticsdown::cond_cmpl("ɔ")`], [`r linguisticsdown::cond_cmpl("ɛ")`], and [`r linguisticsdown::cond_cmpl("ø")`] as reference categories in respective set.

The second group consisted of 11 sets of GAMMs fit to each of the long-short vowel pairs, aiming for an evaluation of differences between categories within pairs. In each set, vowel was treatment coded with the long vowel in each pair as reference vowel.

All GAMMs were fit separately for each of the three formants, which necessarily meant committing to the simplifying assumption of cue independence. Previous work has shown that acoustic cues tend to co-vary [for a review, see @schertz-clare2019]. For vowels, this is the case for F1 and F2, as shown by the shape and orientation of ellipses in Figure \@ref(fig:swe-vowels-by-quantity).

The results of the dynamic analysis are presented in Section \@ref(sec:swehVd-dynamics).

```{r}
# ## Add code to write csv.file for gamm in munich
# write.csv(
#   d.SwehVd %>%
#     filter(Transcribed_vowel == "targeted", Word != "hädd") %>%
#     mutate(
#       rounding = case_when(category %in% c("[yː]", "[ʏ]", "[øː]", "[ø]", "[œː]", "[æ]") ~ "protruded",
#                            category %in% c("[oː]", "[ɔ]", "[uː]", "[ʊ]", "[ʉː]") ~ "inrounded",
#                            TRUE ~ "unrounded")) %>%
#     mutate(across(starts_with("F"), ~ log(.x), .names = "{.col}_log")),
#   file = "../../../data/phonetic vowel statistics/Swedish/Published databases/Persson-2023/outlier-corrected-vowel-data/Persson_2023_SwehVd_vowels.csv",
#   row.names = FALSE, quote = FALSE)

d.cue.values <- d.SwehVd %>%
  filter(!Talker %in% d.SwehVd.exclusions$Talker, Transcribed_vowel == "targeted", Word != "hädd", !is.na(F0), Unreliable_measurement == FALSE) %>%
  # Get the geometric mean F1-F2 across the five time points
  group_by(Talker, Gender, category, Token, Quantity) %>%
  summarise(across(c(F0, F1, F2, F3, Duration), ~ geometric.mean(.x))) %>%
  group_by(Quantity, Gender, category) %>%
  summarise(across(c(F0, F1, F2, F3, Duration), list(geometric.mean, sd), .names = "{.col}.fn{.fn}")) %>%
  mutate(across(where(is.numeric), ~ round(.x, digits = 2))) %>%
  rename_with(~ sub(".fn1$", ".mean", .x), ends_with(".fn1")) %>%
  rename_with(~ sub(".fn2$", ".sd", .x), ends_with(".fn2"))
```

# Results
This study aims to provide a detailed description of the acoustics of all Central Swedish vowels and to evaluate the relative importance of certain cues for specific vowel contrasts, as hypothesized in previous work. These include the importance of lip-rounding (F3) for high vowel distinctions [@fant1959; @fant1969; @fujimura1967; @kuronen2000], to what extent all long-short vowel pairs differ in quality (formants) and quantity (duration) [e.g., @behne-kirk1997; @kuronen2000], and what vowels seem to undergo diphthongization [@kuronen2000; @pelzer-boersma2019]. The dynamic analysis furthermore explores which cues carry information about neighboring vowel distinctions once dynamic information is considered. The results section is divided into two main sections, following the static and dynamic analyses.

## Static spectral and temporal cues to vowel identity {#sec:static}
The static analysis begins with a mapping of the entire 21 category space along F1-F2. Next, the relative contribution of additional cues beyond F1 and F2 is assessed, as well as the extent to which all long-short vowel pairs are qualitatively and quantitatively different.

(ref:swe-vowels-by-quantity) The SwehVd vowel data separated by quantity. Ellipses show bivariate Gaussian 95% confidence interval of vowel means. Vowel labels indicate vowel means across female and male talkers.

```{r swe-vowels-by-quantity, fig.width=base.width*3, fig.height=base.height*1.75, fig.align='center', fig.pos="ht", fig.cap="(ref:swe-vowels-by-quantity)"}
# Vowel plot by quantity
p.normalized <- d.SwehVd.forStudy.long.static %>%
  # Filter down to test folds
  filter(Normalization.Type == "Nearey's uniform scaling (log)") %>%
  ggplot(
    aes(
      x = F2, 
      y = F1)) +
  stat_ellipse(
    mapping = aes(
      colour = category),
    alpha = .5) +
  # Add between-talker mean
  geom_label(
    data =
      . %>%
      group_by(category, Quantity, Normalization.Type) %>%
      summarise(across(c(F1, F2), ~ mean(.x))),
    mapping = aes(
      colour = category,
      label = category,
      fontface = ifelse(Quantity == "long", 2, 1)),
    alpha = .8,
    size = 4,
    label.size = NA,
    label.padding = unit(.06, "cm")) +
  scale_colour_manual(name = "category", values = colors.vowel.swe) +
  scale_x_reverse("F2", position = "top", scales::pretty_breaks(n = 4)) +
  scale_y_reverse("F1", position = "right", scales::pretty_breaks(n = 4)) +
  guides(alpha = "none", color = "none", shape = "none") +
  facet_grid(factor(Normalization.Type, levels = labels.normalization) ~ Quantity)
p.normalized
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

Figure \@ref(fig:swe-vowels-by-quantity), left panel, visualizes the long vowels along the two primary cues to vowel identity, F1-F2.^[The SI presents the mean cue values for the male and female talkers, Tables \@ref(tab:SI-cue-values-long) and \@ref(tab:SI-cue-values-short). As expected, the male talkers have lower formant values and lower F0s than the female talkers (average F0 across long and short categories for female talkers = `r round(d.cue.values %>% filter(Gender == "female") %>% ungroup() %>% summarise(mean = mean(F0.mean)) %>% pull(mean), digits = 0)`, for male talkers = `r round(d.cue.values %>% filter(Gender == "male") %>% ungroup() %>% summarise(mean = mean(F0.mean)) %>% pull(mean), digits = 0)`).] Four vowels cluster in the high front part of the space. The mid-high [`r linguisticsdown::cond_cmpl("eː")`] occupies a substantially higher position than in many previous descriptions, and is also the most fronted vowel [c.f., @fant1969; @kuronen2000; but see @engstrand2000; @pelzer-boersma2019]. The high [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] are rather mid-central, and exhibit substantial overlap with each other and with the neighboring [`r linguisticsdown::cond_cmpl("ʉː")`]. The [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("oː")`], and [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`] categories are also partly overlapping.

The short vowels (right panel), present a slightly more compact space, however with increased category separability [c.f., @riad2014].^[There is a possibility that the increased separability found for the short vowels is partly an artifact of how time-points for cue measurements were selected. Time-points based on percentage of vowel duration will necessarily render measurement points that are closer in time for the shorter vowels, potentially providing a better estimate of the formant value that is most distinctive, i.e., the steady state in the center of the vowel.] For some vowel pairs, overlap is clearly reduced for the short vowels, e.g., for [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], [`r linguisticsdown::cond_cmpl("ɛ")`] - [`r linguisticsdown::cond_cmpl("æ")`], and [`r linguisticsdown::cond_cmpl("ɔ")`] - [`r linguisticsdown::cond_cmpl("ʊ")`]. Of note, the high vowels [`r linguisticsdown::cond_cmpl("ɪ")`] and [`r linguisticsdown::cond_cmpl("ʏ")`] are more fronted and more peripheral than their long counterparts, which does not replicate previous studies [for Central Swedish, see e.g., @fant1971; @kuronen2000; for short-long contrasts in other languages, see e.g., @clopper2005; @hillenbrand1995].<!--check also leinonen--> There are further no indications of neutralization of the short /`r linguisticsdown::cond_cmpl("ø")`/ and /`r linguisticsdown::cond_cmpl("ʉ")`/ as [`r linguisticsdown::cond_cmpl("ɵ")`] among these talkers [c.f., @stahle1965; @wenner2010].

(ref:swe-vowels-all-cues) The SwehVd vowel data shown for all pairwise combinations of five cues: F0, F1, F2, F3 and duration. Panels on the diagonal show marginal cue densities of all five cues. The off-diagonal panels show vowel means across talkers, represented by points and with bivariate Gaussian 95% probability mass ellipses in the upper panels, and represented by vowel labels and with points for each recording in the lower panels. Note that, unlike in Figure \@ref(fig:swe-vowels), axis directions are not reversed.

```{r swe-vowels-all-cues, fig.width=base.width*4, fig.height=base.height*4, out.width = '100%', fig.align='center', fig.cap="(ref:swe-vowels-all-cues)"}
p.matrix.cues <-
  d.SwehVd.forStudy.long.static %>%
  #filter(F3 > .4) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)") %>%
  ggplot(
    aes(
      x = .panel_x,
      y = .panel_y)) +
  geom_point(
    aes(
      colour = category,
      shape = Quantity),
    alpha = .1) +
  geom_label(
    data =
      ~ .x %>%
      group_by(category, Quantity) %>%
      summarise(across(c(F0, F1, F2, F3, Duration), ~ mean(.x))),
    mapping = aes(
      colour = category,
      label = category,
      fontface = ifelse(category %in% levels.vowel.IPA.swe.long, 2, 1),
      fontface = 2),
    alpha = .4, size = 4, label.size = NA) +
  geom_autodensity(
    mapping = aes(fill = category, linetype = Quantity),
    alpha = .3, position = "identity") +
  stat_ellipse(
    mapping = aes(
      colour = category,
      linetype = Quantity),
    alpha = .4) +
  geom_point(
    data =
      ~ .x %>%
      group_by(category, Quantity) %>%
      summarise(across(c(F0, F1, F2, F3, Duration), ~ mean(.x))),
    mapping = aes(
      colour = category,
      shape = Quantity),
    alpha = .8, size = 2) +
  scale_colour_manual(name = "category", values = colors.vowel.swe, aesthetics = c("colour", "fill")) +
  guides(color = "none", fill = "none", linetype = "none") +
  #guides(color = "none", fill = "none", shape = guide_legend(override.aes = list(alpha = .4))) +
  facet_matrix(
    vars(F0, F1, F2, F3, Duration),
    layer.lower = c(1,2),
    layer.diag = 3,
    layer.upper = c(4, 5)) +
  myGplot.defaults(base_size+2) +
  theme(
    legend.position = "top")
p.matrix.cues
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

### Cues and cue correlations
For the pairwise combinations of the five spectral and temporal cues---F0, F1, F2, F3 and duration, see Figure \@ref(fig:swe-vowels-all-cues) from @persson-jaeger2023 updated to include data from the `r nrow(d.SwehVd.forStudy %>% filter(Gender == "male") %>% distinct(Talker))` male talkers. Unsurprisingly, the densities along the diagonal suggest that F0 carries the least information about vowel identity, exhibiting less between-category separation than all other cues.

As is to be expected, vowels differing in quality are most separated in the F1 and F2 panels. Inspecting the off-diagonals in Figure \@ref(fig:swe-vowels-all-cues), the F1-F3 and F3-F2 panels both display increased separation between the neighboring outrounded [`r linguisticsdown::cond_cmpl("yː")`] and inrounded [`r linguisticsdown::cond_cmpl("ʉː")`], and unrounded [`r linguisticsdown::cond_cmpl("ɪ")`] and outrounded [`r linguisticsdown::cond_cmpl("ʏ")`], compared to when plotted along F1-F2, which points to the importance of F3 for these vowels. Interestingly, the almost complete overlap between [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] in F1-F2 space overall remains when F3 is considered, even if individual differences in the amount of overlap exist. Most talkers produce these two vowels very close in F1-F2 space, and only slightly separated in F2-F3 space, while others display a continued overlap when considering F3 (for reference, one talker of each type are displayed in SI Figure \@ref(fig:SI-swe-merge)). This would seem to suggest that F3 might carry less importance as distinctive feature for [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] than previously established [c.f., @fant1959; @fant1969].

In order to quantitatively asses whether the distinction between closely neighboring unrounded and rounded categories increased when F3 was considered, the category separability of these vowels was calculated based on F1 and F2, and subsequently compared against the separability calculated when including F3. If separability were to increase when F3 was added, it would suggest that F3 does contribute to category distinctions.

Three general observations can be made from Figure \@ref(fig:cat-sep-F3). First, category separability is overall lower for some contrasts when only F1 and F2 were considered, e.g., the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`], and [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] contrasts, indicating their overlap in F1-F2 space (Figure \@ref(fig:cat-sep-F3):**column A**). Second, including F3 overall increases category separability, more so for some contrasts than others. The proportional increase in category separability relative to F1-F2 baseline (Figure \@ref(fig:cat-sep-F3):**column B**) is largest for the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], and [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] contrasts. How much separability increases by adding F3 varies quite substantially between talkers for the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] and [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] contrasts, as indicated by the large confidence intervals. Indeed, when assuming talker-independent representations, the relative increase in separability is less pronounced for these contrasts (see additional analyses in SI \@ref(sec:SI-separability-talkerIndep)). Third, the [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] contrast seems to benefit most from the inclusion of F3, resulting in an overall larger increase in separability for the outrounded vs. inrounded contrasts over the unrounded vs. outrounded contrasts.

The LMMs fit to the data (presented in Section \@ref(sec:method-static)) indicated that including F3 improved category separability for all contrasts (all $ps < .003$). This suggests that the subtle differences observed by visual inspection for the [`r linguisticsdown::cond_cmpl("eː")`] - [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("uː")`] and [`r linguisticsdown::cond_cmpl("ɔ")`] - [`r linguisticsdown::cond_cmpl("ʊ")`] contrasts were nevertheless significant (Summary tables in SI \@ref(sec:SI-LMMs-study1)).^[The alpha level for statistical significance used throughout the paper is $p < .05$.]

```{r}
get_category_separability <- function(
    data,
    data_means,
    category_A, 
    category_B) 
  {
  data %>% 
    filter(category == category_A) %>%
    left_join(data_means %>% 
                filter(category == category_B),
              by = "Talker") %>%
    rename(category = category.x, mean_category = category.y) %>%
    group_by(Talker) %>%
    mutate(
      distance_F1F2 = sqrt((F1 - F1_mean)^2 + (F2 - F2_mean)^2),
      distance_F1F3 = sqrt((F1 - F1_mean)^2 + (F3 - F3_mean)^2),
      distance_F2F3 = sqrt((F2 - F2_mean)^2 + (F3 - F3_mean)^2),
      distance_F1F2F3 = sqrt((F1 - F1_mean)^2 + (F2 - F2_mean)^2 + (F3 - F3_mean)^2),
      distance_F1F2duration = sqrt((F1 - F1_mean)^2 + (F2 - F2_mean)^2 + (Duration - Duration_mean)^2),
      distance_F1duration = sqrt((F1 - F1_mean)^2 + (Duration - Duration_mean)^2),
      distance_F2duration = sqrt((F2 - F2_mean)^2 + (Duration - Duration_mean)^2),
      # Calculate SEs for alternative way of assessing CIs
      SE_F1F2 = sd(distance_F1F2) / sqrt(length(distance_F1F2)),
      SE_F1F2F3 = sd(distance_F1F2F3) / sqrt(length(distance_F1F2F3)),
      SE_F1F2duration = sd(distance_F1F2duration) / sqrt(length(distance_F1F2duration)),
      category_separabilityF1F2 = sum(distance_F1F2) / length(distance_F1F2),
      category_separabilityF1F3 = sum(distance_F1F3) / length(distance_F1F3),
      category_separabilityF2F3 = sum(distance_F2F3) / length(distance_F2F3),
      category_separabilityF1F2F3 = sum(distance_F1F2F3) / length(distance_F1F2F3),
      category_separabilityF1F2duration = sum(distance_F1F2duration) / length(distance_F1F2duration),
      category_separabilityF1duration = sum(distance_F1duration) / length(distance_F1duration),
      category_separabilityF2duration = sum(distance_F2duration) / length(distance_F2duration))
  }

# Calculate the separability for additional categories explored further down in dynamic analysis
d.SwehVd.for.cat.separability <- d.SwehVd.forStudy.long.static %>% 
  filter(Normalization.Type == "Nearey's uniform scaling (log)")

d.SwehVd.centroids <- d.SwehVd.for.cat.separability %>%
      group_by(Talker, category) %>%
      summarise(across(c(starts_with("F"), "Duration"), ~ mean(.x), .names = '{col}_mean'))

d.SwehVd.cat.separability <- rbind(
  # Get category separability of i: from y:
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[iː]", category_B = "[yː]", data_means = d.SwehVd.centroids) %>%
    # label the same pairwise comparison as there are no differences between the categories for these contrasts
    mutate(comparison = "iː - yː"),
  # and then y: from i:
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[yː]", category_B = "[iː]", data_means = d.SwehVd.centroids) %>%
  mutate(comparison = "iː - yː"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[yː]", category_B = "[ʉː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "yː - ʉː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ʉː]", category_B = "[yː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "yː - ʉː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[eː]", category_B = "[yː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "eː - yː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[yː]", category_B = "[eː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "eː - yː"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[iː]", category_B = "[eː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "iː - eː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[eː]", category_B = "[iː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "iː - eː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɪ]", category_B = "[ʏ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɪ - ʏ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ʏ]", category_B = "[ɪ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɪ - ʏ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɛː]", category_B = "[æː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɛː - æː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[æː]", category_B = "[ɛː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɛː - æː"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[øː]", category_B = "[œː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "øː - œː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[œː]", category_B = "[øː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "øː - œː"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[ø]", category_B = "[œ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ø - œ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[œ]", category_B = "[ø]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ø - œ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[oː]", category_B = "[uː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "oː - uː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[uː]", category_B = "[oː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "oː - uː"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɔ]", category_B = "[ʊ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɔ - ʊ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ʊ]", category_B = "[ɔ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɔ - ʊ")) %>%
  #average the separability across the two distances
  group_by(comparison, Talker) %>%
  summarise(
      F1F2_SE = geometric.mean(SE_F1F2),
      F1F2F3_SE = geometric.mean(SE_F1F2F3),
      F1F2_separability = mean(category_separabilityF1F2, na.rm = T),
      F1F2F3_separability = mean(category_separabilityF1F2F3, na.rm = T))
```

(ref:cat-sep-F3) The effect of including F3 in measures of category separability for the distinction between neighboring unrounded vs. outrounded vowels (**top row**), and outrounded vs. inrounded vowels (**bottom row**). **Left panels** plot the category separability for F1-F2 and F1-F2-F3 cue combinations. **Right panels** plot the proportional increase in category separability relative to F1-F2-baseline. Pointranges indicate mean and 95% bootstrapped CIs of the category separability summarized across talkers for each cue combination. Axis ranges are held constant across columns.

```{r cat-sep-F3, fig.align='center', fig.width=base.width*3.5, fig.height=base.height*4, out.width='90%', fig.cap="(ref:cat-sep-F3)", message=FALSE}
colors.comparison <- c("#FC8D62", "#FB9A99", "#1B9E77", "#8DA0CB", "#A6CEE3", "#33A02C")
names(colors.comparison) <- c("iː - yː",  "eː - yː", "ɪ - ʏ", "yː - ʉː", "oː - uː", "ɔ - ʊ")

d.SwehVd.cat.separability.for.rounding <- d.SwehVd.cat.separability %>%
  filter(comparison %in% c("iː - yː",  "eː - yː", "ɪ - ʏ", "yː - ʉː", "oː - uː", "ɔ - ʊ")) %>%
  mutate(
    comparison = factor(comparison, levels = c("iː - yː",  "eː - yː", "ɪ - ʏ", "yː - ʉː", "oː - uː", "ɔ - ʊ")),
    rounding = ifelse(comparison %in% c("iː - yː",  "eː - yː", "ɪ - ʏ"), "unrounded vs. outrounded", "outrounded vs. inrounded")) %>%
  pivot_longer(
    cols = starts_with("F"),
    names_to = c("cue_dimension", "measure"),
    names_sep = "_") %>%
  pivot_wider(
    names_from = "measure",
    values_from = "value") %>%
  mutate(
    cue_dimension = factor(cue_dimension, levels = c("F1F2", "F1F2F3")))

# Calculate the relative increase of including F3 for the rounded contrasts
d.SwehVd.cat.separability.comparison <- d.SwehVd.cat.separability %>%
  filter(comparison %in% c(c("iː - yː",  "eː - yː", "ɪ - ʏ", "yː - ʉː", "oː - uː", "ɔ - ʊ"))) %>%
  group_by(comparison) %>%
  mutate(
    separabilityDifference_F3 = (F1F2F3_separability - F1F2_separability) / F1F2_separability)
  
p.category.separability.unrounded <- d.SwehVd.cat.separability.for.rounding %>%
  filter(rounding == "unrounded vs. outrounded") %>%
  group_by(comparison, rounding, cue_dimension) %>%
  mutate(
    ci = list(enframe(Hmisc::smean.cl.boot(separability)))) %>%
    unnest(ci) %>%
    spread(name, value) %>%
  group_by(cue_dimension, comparison, rounding) %>%
    summarise(
      mean_CI_lower = mean(Lower),
      mean_CI_upper = mean(Upper),
      mean = mean(Mean)) %>%
  ggplot(
    aes(x = cue_dimension,
        y = mean,
        ymin = mean_CI_lower,
        ymax = mean_CI_upper,
        color = comparison)) +
  geom_pointrange(
    position = position_dodge2(width = .3),
    fatten = 2.5,
    size = .8) +
  geom_line(aes(group = comparison), position = position_dodge(width = 0.3), linetype = "dashed") +
  scale_color_manual(name = "comparison", values = colors.comparison) + 
  scale_y_continuous("Category separability index", limits = c(.05, .53)) +
  guides(shape = "none") +
  myGplot.defaults() +
  theme(axis.title.x = element_blank(),
        axis.text.x = ggtext::element_markdown(angle = 60, vjust = 1, hjust = 1),
        legend.title = element_blank(),
        legend.position = "bottom")

p.category.separability.inrounded <- p.category.separability.unrounded %+%
  (d.SwehVd.cat.separability.for.rounding %>%
  filter(rounding == "outrounded vs. inrounded") %>%
  group_by(comparison, rounding, cue_dimension) %>%
  mutate(
    ci = list(enframe(Hmisc::smean.cl.boot(separability)))) %>%
    unnest(ci) %>%
    spread(name, value) %>%
  group_by(cue_dimension, comparison, rounding) %>%
    summarise(
      mean_CI_lower = mean(Lower),
      mean_CI_upper = mean(Upper),
      mean = mean(Mean)))

p.category.separability.diff.unrounded <- d.SwehVd.cat.separability.comparison %>%
  select(comparison, separabilityDifference_F3) %>%
  filter(comparison %in% c("iː - yː",  "eː - yː", "ɪ - ʏ")) %>%
  pivot_longer(
    cols = starts_with("separabilityDifference"),
    names_to = "cue_difference") %>%
  rbind(d.SwehVd.cat.separability.comparison %>% 
          select(comparison, separabilityDifference_F3) %>%
          filter(comparison %in% c("iː - yː",  "eː - yː", "ɪ - ʏ")) %>%
          group_by(comparison) %>%
          summarise(
            separabilityDifference_F3 = mean(separabilityDifference_F3)) %>%
          pivot_longer(
            cols = starts_with("separabilityDifference"),
            names_to = "cue_difference") %>%
          mutate(comparison = "overall")) %>%
  mutate(
    comparison = factor(comparison, levels = c("iː - yː",  "eː - yː", "ɪ - ʏ", "overall")),
    rounding = "unrounded vs. outrounded",
    cue_difference = factor(cue_difference, levels = "separabilityDifference_F3", labels = "F3-inclusion")) %>%
  rename(separability_diff = value) %>%
  group_by(comparison, rounding, cue_difference) %>%
  mutate(
    ci = list(enframe(Hmisc::smean.cl.boot(separability_diff)))) %>%
    unnest(ci) %>%
    spread(name, value) %>%
  group_by(cue_difference, comparison, rounding) %>%
    summarise(
      mean_CI_lower = mean(Lower),
      mean_CI_upper = mean(Upper),
      mean = mean(Mean)) %>%
  ggplot(
    aes(x = comparison,
        y = mean,
        ymin = mean_CI_lower,
        ymax = mean_CI_upper,
        color = cue_difference)) +  
  geom_pointrange(
    position = position_dodge2(width = .6),
    fatten = 2.5,
    size = .8) +
  geom_hline(
    aes(
      yintercept = 0),
    color = "gray", 
    linetype = 2) +
  scale_color_brewer(palette = "Dark2") +
  scale_y_continuous("Increase in category separability relative to F1-F2", limits = c(-.05, 1)) +
  guides(shape = "none") +
  myGplot.defaults() +
  theme(axis.text.x = ggtext::element_markdown(angle = 60, vjust = 1, hjust = 1),
        axis.title.x = element_blank(),
        legend.title = element_blank(),
        legend.position = "bottom")

p.category.separability.diff.inrounded <- p.category.separability.diff.unrounded %+%
  (d.SwehVd.cat.separability.comparison %>%
     select(comparison, separabilityDifference_F3) %>%
     filter(comparison %in% c("yː - ʉː", "oː - uː", "ɔ - ʊ")) %>%
     pivot_longer(
       cols = starts_with("separabilityDifference"),
       names_to = "cue_difference") %>%
     rbind(d.SwehVd.cat.separability.comparison %>% 
             select(comparison, separabilityDifference_F3) %>%
             filter(comparison %in% c("yː - ʉː", "oː - uː", "ɔ - ʊ")) %>%
             group_by(comparison) %>%
             summarise(
               separabilityDifference_F3 = mean(separabilityDifference_F3)) %>%
             pivot_longer(
               cols = starts_with("separabilityDifference"),
               names_to = "cue_difference") %>%
             mutate(comparison = "overall")) %>%
     mutate(
       comparison = factor(comparison, levels = c("yː - ʉː", "oː - uː", "ɔ - ʊ", "overall")),
       rounding = "outrounded vs. inrounded",
       cue_difference = factor(cue_difference, levels = "separabilityDifference_F3", labels = "F3-inclusion")) %>%
  rename(separability_diff = value) %>%
  group_by(comparison, rounding, cue_difference) %>%
  mutate(
    ci = list(enframe(Hmisc::smean.cl.boot(separability_diff)))) %>%
    unnest(ci) %>%
    spread(name, value) %>%
  group_by(cue_difference, comparison, rounding) %>%
    summarise(
      mean_CI_lower = mean(Lower),
      mean_CI_upper = mean(Upper),
      mean = mean(Mean)))

(p.category.separability.unrounded + facet_wrap(~rounding) + p.category.separability.diff.unrounded + facet_wrap(~rounding)) /
(p.category.separability.inrounded + facet_wrap(~rounding) + (p.category.separability.diff.inrounded + facet_wrap(~rounding) + theme(legend.position = "none"))) +
  plot_annotation(tag_levels = list(c('A', 'B', '', '')))
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

```{r message=FALSE}
contrasts(d.SwehVd.cat.separability.for.rounding$cue_dimension) <- contr.treatment(2)

# Rename contrast labels
d.SwehVd.cat.separability.for.rounding$cue_dimension <- factor(d.SwehVd.cat.separability.for.rounding$cue_dimension, labels = c("F1F2", "F1F2F3"))

m.sep.IIYY <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.rounding %>% filter(comparison == "iː - yː"))

m.sep.EEYY <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.rounding %>% filter(comparison == "eː - yː"))

m.sep.IY <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.rounding %>% filter(comparison == "ɪ - ʏ"))

m.sep.YYUU <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.rounding %>% filter(comparison == "yː - ʉː"))

m.sep.ÅÅOO <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.rounding %>% filter(comparison == "oː - uː"))

m.sep.ÅO <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.rounding %>% filter(comparison == "ɔ - ʊ"))
```

### Quantity vs. quality in long and short vowel pairs
To gain more insight into the extent to which there are spectral and temporal differences between long and short vowels, the acoustics of categories within vowel pairs were evaluated. This allows for an assessment of whether quantity and quality distinctions seem to be separate from each other.

As expected, long-short vowel pairs differ systematically in duration (Figure \@ref(fig:duration-densities)). For each vowel pair, the duration densities in Figure \@ref(fig:duration-densities) are overlapping but with two clearly separable peaks (mean duration for the long vowels = `r round(d.SwehVd.forStudy.long %>% filter(Quantity == "long") %>% summarise(mean(Duration)) %>% pull(), digits = 2)` ms, SD = `r round(d.SwehVd.forStudy.long %>% filter(Quantity == "long") %>% summarise(sd(Duration)) %>% pull(), digits = 2)`; mean duration for the short vowels = `r round(d.SwehVd.forStudy.long %>% filter(Quantity == "short") %>% summarise(mean(Duration)) %>% pull(), digits = 2)` ms, SD = `r round(d.SwehVd.forStudy.long %>% filter(Quantity == "short") %>% summarise(sd(Duration)) %>% pull(), digits = 2)`). Overall, the short vowels display less variability in duration than the long vowels, a common pattern for measures with a lower bound.

(ref:duration-densities) Illustrating the systematic differences in duration between the long and short vowel pairs in SwehVd.

```{r duration-densities, fig.width= base.width * 3, fig.height = base.height * 2, fig.align='center', out.width='95%', fig.cap="(ref:duration-densities)"}
# Generate dataframe with vowel pairs
d.SwehVd.vowel_pairs <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  #filter(F3 > .25) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)")  %>%
  mutate(
    vowel_pair = case_when(category %in% c("[ɪ]", "[iː]") ~ "ɪ - iː",
                           category %in% c("[ʏ]", "[yː]") ~ "ʏ - yː",
                           category %in% c("[ɵ]", "[ʉː]") ~ "ɵ - ʉː",
                           category %in% c("[ɛ]", "[eː]", "[ɛː]") ~ "ɛ - eː, ɛː",
                           category %in% c("[æ]", "[æː]") ~ "æ - æː",
                           category %in% c("[ø]", "[øː]") ~ "ø - øː",
                           category %in% c("[œ]", "[œː]") ~ "œ - œː",
                           category %in% c("[a]", "[ɑː]") ~ "a - ɑː",
                           category %in% c("[ɔ]", "[oː]") ~ "ɔ - oː",
                           category %in% c("[ʊ]", "[uː]") ~ "ʊ - uː")) %>%
  # Do additional sets for the three-way contrast
  rbind(
    d.SwehVd.forStudy.long.dynamic %>%
      select(-starts_with("formant")) %>%
      filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɛ]", "[eː]")) %>%
      mutate(
        vowel_pair = "ɛ - eː"),
    d.SwehVd.forStudy.long.dynamic %>%
      select(-starts_with("formant")) %>%
      filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɛ]", "[ɛː]")) %>%
      mutate(
        vowel_pair = "ɛ - ɛː"))

d.SwehVd.vowel_pairs %>%
  filter(!vowel_pair %in% c("ɛ - eː", "ɛ - ɛː")) %>%
  ggplot(
    aes(Duration, fill = factor(category))) +
  geom_density(alpha = .5) +
  theme(legend.position = "none") +
  scale_colour_manual(name = "category", values = colors.vowel.swe, aesthetics = c("colour", "fill")) +
  guides(linetype = "none", color = "none", fill = "none") +
  facet_wrap(~ factor(vowel_pair, levels = c("ɪ - iː", "ʏ - yː", "ɵ - ʉː", "ɛ - eː, ɛː", "æ - æː", "ø - øː", "œ - œː", "a - ɑː", "ɔ - oː", "ʊ - uː")), nrow = 2)
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

All long-short vowel pairs furthermore display spectral differences in F1-F2. In fact, as indicated in Figure \@ref(fig:swe-vowels), formant differences are apparent for *all* vowel pairs, even for vowel distinctions for which duration has been found to be the primary cue---[`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`], [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("ø")`], [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("ɪ")`], and [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("ɔ")`] [e.g., @behne-kirk1997; @haddingkoch1964; @kuronen2000]. The vowel pairs that display larger spectral differences along F1-F2 seem to be [`r linguisticsdown::cond_cmpl("ʉː")`] - [`r linguisticsdown::cond_cmpl("ɵ")`] and [`r linguisticsdown::cond_cmpl("ɑː")`] - [`r linguisticsdown::cond_cmpl("a")`] [in line with e.g., @fant1983; @kuronen2000], but also [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`], which contrasts with previous studies. The large spectral differences in [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`] are presumably due to [`r linguisticsdown::cond_cmpl("ɛː")`] being produced very low in the SwehVd database, which increases the distance to [`r linguisticsdown::cond_cmpl("ɛ")`] and in addition leads to a gap along the top-left to bottom-left diagonal between [`r linguisticsdown::cond_cmpl("eː")`] and [`r linguisticsdown::cond_cmpl("ɛ")`]. Overall, F2 appears to carry more of the spectral variation between the long and short vowel phonemes, as categories display increased separability in the pairwise combination of F2 and duration (Figure \@ref(fig:swe-vowels-all-cues), rightmost column, third row).

In order to evaluate what cue combination would provide the largest separability between vowels in long-short contrasts, the category separability index was calculated for each pair and three different cue combinations: F1-F2, F1-F2-F3, or F1-F2-Duration.^[For an approximation of the relative separability by cue, evaluations of F1-F3, F2-F3, F1-Duration and F2-Duration are included in the SI \@ref(sec:SI-separability).]

```{r message=FALSE}
#Calculate separability for all long-short pairs for three-way comparison
d.SwehVd.cat.separability.long.short <- rbind(
  # Get category separability of i: from y:
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[iː]", category_B = "[ɪ]", data_means = d.SwehVd.centroids) %>%
    # label the same pairwise comparison as there are no differences between the categories for these contrasts
    mutate(comparison = "iː - ɪ"),
  # and then y: from i:
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɪ]", category_B = "[iː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "iː - ɪ"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[yː]", category_B = "[ʏ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "yː - ʏ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ʏ]", category_B = "[yː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "yː - ʏ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ʉː]", category_B = "[ɵ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ʉː - ɵ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɵ]", category_B = "[ʉː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ʉː - ɵ"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[eː]", category_B = "[ɛ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "eː - ɛ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɛ]", category_B = "[eː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "eː - ɛ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɛː]", category_B = "[ɛ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɛː - ɛ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɛ]", category_B = "[ɛː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɛː - ɛ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[æː]", category_B = "[æ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "æː - æ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[æ]", category_B = "[æː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "æː - æ"),
    d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[øː]", category_B = "[ø]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "øː - ø"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ø]", category_B = "[øː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "øː - ø"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[œː]", category_B = "[œ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "œː - œ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[œ]", category_B = "[œː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "œː - œ"),
  d.SwehVd.for.cat.separability %>%
    get_category_separability(category_A = "[ɑː]", category_B = "[a]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɑː - a"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[a]", category_B = "[ɑː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "ɑː - a"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[oː]", category_B = "[ɔ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "oː - ɔ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ɔ]", category_B = "[oː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "oː - ɔ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[uː]", category_B = "[ʊ]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "uː - ʊ"),
  d.SwehVd.for.cat.separability %>%
  get_category_separability(category_A = "[ʊ]", category_B = "[uː]", data_means = d.SwehVd.centroids) %>%
    mutate(comparison = "uː - ʊ")) %>%
  #average the separability across the two distances
  group_by(comparison, Talker) %>%
  summarise(
      F1F2_SE = geometric.mean(SE_F1F2),
      F1F2F3_SE = geometric.mean(SE_F1F2F3),
      F1F2Duration_SE = geometric.mean(SE_F1F2duration),
      F1F2_separability = mean(category_separabilityF1F2, na.rm = T),
      F1F2F3_separability = mean(category_separabilityF1F2F3, na.rm = T),
      F1F3_separability = mean(category_separabilityF1F3, na.rm = T),
      F2F3_separability = mean(category_separabilityF2F3, na.rm = T),
      F1F2Duration_separability = mean(category_separabilityF1F2duration, na.rm = T),
      F1Duration_separability = mean(category_separabilityF1duration, na.rm = T),
      F2Duration_separability = mean(category_separabilityF2duration, na.rm = T))

d.SwehVd.cat.separability.for.longshort <- d.SwehVd.cat.separability.long.short %>%
  mutate(
    comparison = factor(comparison, levels = c("iː - ɪ",  "yː - ʏ", "ʉː - ɵ", "eː - ɛ", "oː - ɔ", "uː - ʊ", "ɛː - ɛ", "æː - æ", "øː - ø", "œː - œ", "ɑː - a"))) %>%
  pivot_longer(
    cols = starts_with("F"),
    names_to = c("cue_dimension", "measure"),
    names_sep = "_") %>%
  pivot_wider(
    names_from = "measure",
    values_from = "value") %>%
  mutate(
    height = ifelse(comparison %in% c("iː - ɪ",  "yː - ʏ", "ʉː - ɵ", "eː - ɛ", "oː - ɔ", "uː - ʊ"), "high vowels", "lower-mid vowels"))

# Save separate dataframe for additional evaluations in SI
d.SwehVd.cat.separability.for.longshort.SI <- d.SwehVd.cat.separability.for.longshort

d.SwehVd.cat.separability.for.longshort %<>%
  filter(cue_dimension %in% c("F1F2", "F1F2F3", "F1F2Duration")) %>%
  mutate(
    cue_dimension = factor(cue_dimension, levels = c("F1F2", "F1F2F3", "F1F2Duration")))
```

(ref:cat-sep-long-short) The effect of including F3 and duration in measures of category separability for long-short vowel pair distinctions. For visualization purposes, the pairs are split into high vowels (**top row**), and lower-mid vowels (**bottom row**). **Left panels** plot the category separability for F1-F2, F1-F2-F3 and F1-F2-duration cue combinations. **Right panels** plot the increase in category separability relative to F1-F2-baseline. Pointranges indicate mean and 95% bootstrapped CIs of the category separability summarized across talkers for each cue combination. Axis ranges are held constant across columns.

```{r cat-sep-long-short, fig.width=base.width*4, fig.height=base.height*4.5, out.width='100%', fig.align='center', fig.cap="(ref:cat-sep-long-short)", message=FALSE, warning=FALSE}
colors.comparison <- c("#66C2A5", "#FC8D62", "#8DA0CB", "#FB9A99", "#E7298A", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", "#A6CEE3", "#33A02C")
names(colors.comparison) <- c("iː - ɪ",  "yː - ʏ", "ʉː - ɵ", "eː - ɛ", "ɛː - ɛ", "æː - æ", "øː - ø", "œː - œ", "ɑː - a",  "oː - ɔ", "uː - ʊ")

p.category.separability.high <- d.SwehVd.cat.separability.for.longshort %>%
group_by(cue_dimension, comparison) %>%
  mutate(
    ci = list(enframe(Hmisc::smean.cl.boot(separability)))) %>%
    unnest(ci) %>%
    spread(name, value) %>%
  filter(height == "high vowels") %>%
  group_by(cue_dimension, comparison, height) %>%
    summarise(
      mean_CI_lower = mean(Lower),
      mean_CI_upper = mean(Upper),
      mean = mean(Mean, na.rm = T)) %>%
  ggplot(
    aes(x = cue_dimension,
        y = mean,
        ymin = mean_CI_lower,
        ymax = mean_CI_upper,
        color = comparison)) +
  geom_pointrange(
    position = position_dodge2(width = 0.3),
    fatten = 2.5,
    size = .8) +
  geom_line(aes(group = comparison), position = position_dodge(width = 0.3), linetype = "dashed") +
  scale_color_manual(name = "comparison", values = colors.comparison) +
  scale_y_continuous("Category separability index", limits = c(.05, .53)) +
  guides(shape = "none", color = guide_legend(nrow = 2)) +
  myGplot.defaults() +
  theme(axis.title.x = element_blank(),
        axis.text.x = ggtext::element_markdown(angle = 60, vjust = 1, hjust = 1),
        legend.position = "bottom",
        legend.title = element_blank())

p.category.separability.lowermid <- p.category.separability.high %+%
  (d.SwehVd.cat.separability.for.longshort %>%
     group_by(cue_dimension, comparison) %>%
     mutate(
       comparison = factor(comparison, levels = c("iː - ɪ",  "yː - ʏ", "ʉː - ɵ", "eː - ɛ", "oː - ɔ", "uː - ʊ", "ɛː - ɛ", "æː - æ", "øː - ø", "œː - œ", "ɑː - a")),
       height = ifelse(comparison %in% c("iː - ɪ",  "yː - ʏ", "ʉː - ɵ", "eː - ɛ", "oː - ɔ", "uː - ʊ"), "high vowels", "lower-mid vowels"),
       ci = list(enframe(Hmisc::smean.cl.boot(separability)))) %>%
     unnest(ci) %>%
     spread(name, value) %>%
     filter(height == "lower-mid vowels") %>%
     group_by(cue_dimension, comparison, height) %>%
     summarise(
       mean_CI_lower = mean(Lower),
       mean_CI_upper = mean(Upper),
       mean = mean(Mean, na.rm = T)))
  
# Calculate the relative increase of including F3 and duration for the quantity contrasts
d.SwehVd.cat.separability.comparison.longshort <- d.SwehVd.cat.separability.long.short %>%
  group_by(comparison) %>%
  mutate(
    separabilityDifference_F3 = (F1F2F3_separability - F1F2_separability) / F1F2_separability,
    separabilityDifference_Duration = (F1F2Duration_separability - F1F2_separability) / F1F2_separability,
    height = ifelse(comparison %in% c("iː - ɪ",  "yː - ʏ", "ʉː - ɵ", "eː - ɛ", "oː - ɔ", "uː - ʊ"), "high vowels", "lower-mid vowels"))

p.category.separability.diff.high <- p.category.separability.diff.unrounded %+%
  (d.SwehVd.cat.separability.comparison.longshort %>%
     select(comparison, height, separabilityDifference_F3, separabilityDifference_Duration) %>%
     filter(height == "high vowels") %>%
     pivot_longer(
       cols = starts_with("separabilityDifference"),
       names_to = "cue_difference") %>%
     mutate(
       comparison = factor(comparison, levels = c("iː - ɪ",  "yː - ʏ", "ʉː - ɵ", "eː - ɛ", "oː - ɔ", "uː - ʊ", "overall")),
       height = "high vowels",
       cue_difference = factor(cue_difference, levels = c("separabilityDifference_F3", "separabilityDifference_Duration"), labels = c("F3-inclusion", "Duration-inclusion"))) %>%
     rename(separability_diff = value) %>%
     group_by(comparison, height, cue_difference) %>%
     mutate(
       ci = list(enframe(Hmisc::smean.cl.boot(separability_diff)))) %>%
     unnest(ci) %>%
     spread(name, value) %>%
     group_by(cue_difference, height, comparison) %>%
     summarise(
       mean_CI_lower = mean(Lower),
       mean_CI_upper = mean(Upper),
       mean = mean(Mean)))

p.category.separability.diff.lowermid <- p.category.separability.diff.high %+%
  (d.SwehVd.cat.separability.comparison.longshort %>%
     select(comparison, height, separabilityDifference_F3, separabilityDifference_Duration) %>%
     filter(height == "lower-mid vowels") %>%
     pivot_longer(
       cols = starts_with("separabilityDifference"),
       names_to = "cue_difference") %>%
     mutate(
       comparison = factor(comparison, levels = c("ɛː - ɛ", "æː - æ", "øː - ø", "œː - œ", "ɑː - a", "overall")),
       height = "lower-mid vowels",
       cue_difference = factor(cue_difference, levels = c("separabilityDifference_F3", "separabilityDifference_Duration"), labels = c("F3-inclusion", "Duration-inclusion"))) %>%
     rename(separability_diff = value) %>%
     group_by(comparison, height, cue_difference) %>%
     mutate(
       ci = list(enframe(Hmisc::smean.cl.boot(separability_diff)))) %>%
     unnest(ci) %>%
     spread(name, value) %>%
     group_by(cue_difference, comparison, height) %>%
     summarise(
       mean_CI_lower = mean(Lower),
       mean_CI_upper = mean(Upper),
       mean = mean(Mean)))

(p.category.separability.high + facet_wrap(~height) + p.category.separability.diff.high + facet_wrap(~height)) /
(p.category.separability.lowermid + facet_wrap(~height) + (p.category.separability.diff.lowermid + facet_wrap(~height) + theme(legend.position = "none"))) +
  plot_annotation(tag_levels = list(c('A', 'B', '', ''))) #+
  plot_layout(guides = "collect") &
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        #legend.margin = margin(0, 0, 0, 0, unit = "pt"),
        plot.tag = element_text(face = "bold"))

#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

```{r message=FALSE}
contrasts(d.SwehVd.cat.separability.for.longshort$cue_dimension) <- contr.treatment(3)

# Rename contrast labels
d.SwehVd.cat.separability.for.longshort$cue_dimension <- factor(d.SwehVd.cat.separability.for.longshort$cue_dimension, labels = c("F1F2", "F1F2F3", "F1F2Duration"))

m.sep.I <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "iː - ɪ"))

m.sep.Y <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "yː - ʏ"))

m.sep.U <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "ʉː - ɵ"))

m.sep.E <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "eː - ɛ"))

m.sep.Ä <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "ɛː - ɛ"))

m.sep.ÄR <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "æː - æ"))

m.sep.Ö <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "øː - ø"))

m.sep.ÖR <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "œː - œ"))

m.sep.A <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "ɑː - a"))

m.sep.Å <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "oː - ɔ"))

m.sep.O <- lmerTest::lmer(separability ~ cue_dimension + (1|Talker),
                      data = d.SwehVd.cat.separability.for.longshort %>% filter(comparison == "uː - ʊ"))
```

Figure \@ref(fig:cat-sep-long-short) indicates that category separability is generally higher for some pairs. For instance, the [`r linguisticsdown::cond_cmpl("eː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`], [`r linguisticsdown::cond_cmpl("ʉː")`] - [`r linguisticsdown::cond_cmpl("ɵ")`], and [`r linguisticsdown::cond_cmpl("ɑː")`] - [`r linguisticsdown::cond_cmpl("a")`] pairs display the largest separability when only F1-F2 is considered (Figure \@ref(fig:cat-sep-long-short):**column A**). The inclusion of additional cues unsurprisingly increases category separability for all pairs, more so for pairs that are less separable in F1-F2 space (e.g., [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("ʊ")`], [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], [`r linguisticsdown::cond_cmpl("æː")`] - [`r linguisticsdown::cond_cmpl("æ")`], [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("ø")`], and [`r linguisticsdown::cond_cmpl("œː")`] - [`r linguisticsdown::cond_cmpl("œ")`]). The inclusion of duration overall maximizes the increase in separability relative to baseline (Figure \@ref(fig:cat-sep-long-short):**column B**). Interestingly, this is not the case for [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] that achieves the highest separability for the F1-F2-F3 combination. This would overall seem to suggest that the first two formants and duration are the most important cues to long-short vowel pair distinctions, while the inclusion of F3 unsurprisingly does not punish the separability.^[Analyses of additional cue combinations in the SI \@ref(sec:SI-separability) (F1-F3, F2-F3, F1-Duration, F2-Duration) suggested that duration contributed more to separability than F3 for the [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`], [`r linguisticsdown::cond_cmpl("æː")`] - [`r linguisticsdown::cond_cmpl("æ")`], [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("ø")`], [`r linguisticsdown::cond_cmpl("œː")`] - [`r linguisticsdown::cond_cmpl("œ")`], and [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("ʊ")`] vowel pairs, while for the [`r linguisticsdown::cond_cmpl("ʉː")`] - [`r linguisticsdown::cond_cmpl("ɵ")`], [`r linguisticsdown::cond_cmpl("eː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`], [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("ɔ")`], [`r linguisticsdown::cond_cmpl("ɑː")`] - [`r linguisticsdown::cond_cmpl("a")`] contrasts, combining one spectral cue with duration decreased separability relative to baseline, hence highlighting the reliance on both F1-F2 over duration.]

These findings were confirmed by the statistical analysis (Summary tables in SI \@ref(sec:SI-LMMs-study1)): the LMMs indicated that the F1-F2-Duration cue combination generated the highest separability for all pairs (all $ps > .0001$), with the exception of the [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] contrast, for which the F1-F2-F3 combination achieved the highest separability ($\hat\beta = .058, SE = .004, p < .0001$). The inclusion of F3 nevertheless increased separability relative to F1-F2 for all pairs (all $ps > .01$), with the [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`] ($\hat\beta = .01, SE = .004, p > .009$) and [`r linguisticsdown::cond_cmpl("œː")`] - [`r linguisticsdown::cond_cmpl("œ")`] ($\hat\beta = .009, SE = .0034, p < .01$) pairs displaying overall smaller but statistically significant differences. 

To sum up, the results of the static analysis suggest that F1, F2 and duration are the most important cues to vowel distinctions in Central Swedish. While visual inspection suggested that including F3 did not substantially increase category separability for some neighboring rounded vs. unrounded contrasts, the statistical analysis found significant improvements in separability for all contrasts. This highlights subtle but significant differences, and the advantages of expanding empirical analyses to modeling approaches. 

In addition, even though all long-short vowel pairs differed systematically in duration, they also displayed considerable spectral differences, suggesting that quantity distinctions---long vs. short vowels---are not separate from quality distinctions---high, low, front, back vowels. The comparison of how the category separability within each pair changed as a function of cue combination furthermore highlighted the importance of F1 and F2, with F2 carrying much of the informativity for several pairs. The F1-F2-duration combination generated the highest separability for all pairs but the [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], where F3-inclusion maximized separability of the cue combinations considered, highlighting the importance of F3 for this contrast.

Given that the category separability index assigns equal weight to all cues included, there is no direct way of knowing which cue contributes more to separability. Furthermore, similar to other evaluations presented in this subsection, the separability index cannot account for the fact that formants are not static but rather fluctuate across the signal. A more holistic mapping of the acoustics should therefore aim to assess how formant dynamics contribute to vowel distinctions. The next section investigates how formants move across the segment and how much information is gained by accounting for this dynamics.

## Dynamic spectral analysis {#sec:swehVd-dynamics}
This section begins with visualizations of the empirical data in formant trajectory plots. Next, the results of the GAMMs fit to the data are presented, first focusing on the dynamics in eight sets of neighboring vowel contrasts, and subsequently on the long and short vowel pairs.

### Formant movements across the space {#sec:swehVd-trajectories}
Figure \@ref(fig:trajectories) displays the formant trajectories across all 5 time-points for the long and the short vowels. In almost all vowels, long or short, formants showed a dynamic pattern. Only [`r linguisticsdown::cond_cmpl("øː")`], [`r linguisticsdown::cond_cmpl("ɪ")`], and [`r linguisticsdown::cond_cmpl("ʏ")`] showed very little movement over the measurement points. The scope and direction, however, vary. Across vowels, the scope of movements appear to be larger moving from vowel mid-point to 80% into the vowel, as indicated by the length of the line from vowel label to end of arrow. Most of the formant dynamics thus take place *after* vowel mid-point. The long high front vowels are important exceptions---the dynamics in [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] mostly occur at the beginning of the vowel segment (between 20 and 50% into the vowel), whereas [`r linguisticsdown::cond_cmpl("ʉː")`] displays movements of almost equal magnitude across the first four time-points. The largest movements overall seem to concern [`r linguisticsdown::cond_cmpl("eː")`] and [`r linguisticsdown::cond_cmpl("oː")`].

(ref:trajectories) The trajectory of all vowels across the five time-points, along F1-F2. The arrow indicates the direction of the trajectory and ends at the final time-point, at 80% into the vowel. The vowel label is placed at the third time-point, at vowel mid-point (50%). The first (20%), second (35%) and forth (65%) time-points are represented by points.

```{r trajectories, fig.width=base.width*3, fig.height=base.height*1.75, out.width='90%', fig.align='center', fig.cap="(ref:trajectories)"}
p.trajectories <- d.SwehVd.forStudy.long.dynamic %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)") %>%
  mutate(timepoint = as.character(timepoint)) %>%
  group_by(Talker, category, timepoint, Quantity) %>%
  summarise(across(c(F1, F2), ~mean(.x))) %>%
  group_by(category, timepoint, Quantity) %>%
  summarise(across(c(F1, F2), ~mean(.x))) %>%
  ggplot(
    aes(
      x = F2,
      y = F1,
      color = category,
      group = NULL)) +
  geom_point(
    data = . %>%
      filter(!timepoint %in% c("50", "80")),
    alpha = .3) +
  geom_path(
    alpha = .5,
    arrow = arrow(ends = "last", type = "closed", angle = "22.5", length = unit(.2, "cm"))) +
  geom_label(
    data = . %>%
      filter(timepoint == "50"),
    mapping = aes(
      colour = category,
      label = category,
      fontface = ifelse(category %in% levels.vowel.IPA.swe.long, 2, 1)),
    alpha = .6,
    size = 4,
    label.size = NA,
    label.padding = unit(.01, "cm")) +
  scale_color_manual(name = "category", values = colors.vowel.swe) +
  scale_x_reverse("F2", position = "top", scales::pretty_breaks(n = 6)) +
  scale_y_reverse("F1", position = "right", scales::pretty_breaks(n = 6)) +
  guides(color = "none") +
  facet_wrap(~Quantity, labeller = label_wrap_gen(multi_line=FALSE))
p.trajectories
# d.SwehVd %>%
#   filter(Transcribed_vowel == "targeted", Word != "hädd") %>%
#   mutate(timepoint = as.character(timepoint), 
#          Token = as.factor(Token),
#          red_speaker = Talker == "SW_015") %>%
#   group_by(Talker, category, timepoint, red_speaker) %>%
#   summarise(across(c(F1, F2, F3), ~geometric.mean(.x))) %>%
#   ggplot(
#     aes(x = timepoint, y = F3, group = Talker, color = red_speaker)) +
#   geom_line() +
#   facet_wrap(~category)
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)

#Generate a subset of d-measurements manually
#d.F2d <- read_csv2('../../data/final-d.csv')
```

In terms of directionality, there is a general tendency to move towards the centre in most of the vowels, both long and short. According to previous studies [e.g., @bleckert1987; @elert2000], the high vowels [`r linguisticsdown::cond_cmpl("iː")`], [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("ʉː")`] and [`r linguisticsdown::cond_cmpl("uː")`] tend to be realized with an offglide, which would generate a falling F1 for all four vowels, a rising F2 for [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] and a falling F2 for [`r linguisticsdown::cond_cmpl("ʉː")`] and [`r linguisticsdown::cond_cmpl("uː")`]. These predictions were borne out for F1 in all cases, but for F2, only for [`r linguisticsdown::cond_cmpl("ʉː")`]. Both [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] display very little movement along F2, whereas [`r linguisticsdown::cond_cmpl("uː")`] moves towards a more central quality, possibly indicating diphthongization ending in [`r linguisticsdown::cond_cmpl("ə")`] rather than a consonantal offglide. 
Parts of the movements could be due to coarticulatory effects in anticipation of the upcoming coda ([`r linguisticsdown::cond_cmpl("d")`], [`r linguisticsdown::cond_cmpl("ɖ")`], [`r linguisticsdown::cond_cmpl("r")`]). If so, one would expect F2 to centralize in the later part of the segment, as tongue movements mark transitions into the alveolar [e.g., @hillenbrand2001; @stevens-house1963]. The formant movements along F2 from the last point (65%) to arrow tip (80%) in e.g., [`r linguisticsdown::cond_cmpl("ɵ")`], [`r linguisticsdown::cond_cmpl("œː")`], [`r linguisticsdown::cond_cmpl("œ")`], [`r linguisticsdown::cond_cmpl("ɑː")`], [`r linguisticsdown::cond_cmpl("ɔ")`], [`r linguisticsdown::cond_cmpl("uː")`], and [`r linguisticsdown::cond_cmpl("ʊ")`], might at least partly be caused by such coarticulation. Given the scope and direction of movements, Figure \@ref(fig:trajectories) suggests diphthongization in primarily [`r linguisticsdown::cond_cmpl("eː")`], [`r linguisticsdown::cond_cmpl("ʉː")`] and [`r linguisticsdown::cond_cmpl("oː")`], replicating previous work [e.g., @eklund1997; @elert2000; @pelzer-boersma2019], while the other vowels appear to merely display formant movement, that partly could be caused by e.g., coarticulation. The previously reported diphthongization in [`r linguisticsdown::cond_cmpl("øː")`], however, does not seem to be particularly pronounced in these data.

Figure \@ref(fig:trajectories) further demonstrates that some neighbouring categories either converge at end points or diverge at end points. For instance, [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("oː")`] are fairly closely located at earlier time-points, but differ substantially towards the end of the vowel segment, while [`r linguisticsdown::cond_cmpl("ɛː")`]-[`r linguisticsdown::cond_cmpl("æː")`], [`r linguisticsdown::cond_cmpl("øː")`]-[`r linguisticsdown::cond_cmpl("œː")`] and [`r linguisticsdown::cond_cmpl("ø")`]-[`r linguisticsdown::cond_cmpl("œ")`] start at different locations but end up in approximately the same [c.f., @kuronen2000].<!--add: the overlap found at earlier tps in i-y-e in kuronen, does not seem to replicate here--> Finally, the formant trajectories suggest that the empty spots identified in the vowel space under a static analysis (Figure \@ref(fig:swe-vowels)), may indeed be occupied when vowel dynamics are considered. This is especially true for [`r linguisticsdown::cond_cmpl("eː")`] that travels from the mid-high front to the mid center of the space as the signal unfolds, down to a position closer to its short counterpart, [`r linguisticsdown::cond_cmpl("ɛ")`]. Given the amount of overlap when static spectral cues are considered (Figure \@ref(fig:swe-vowels-by-quantity)), formant dynamics are likely highly informative for several of these distinctions. Figure \@ref(fig:trajectory-ellipses) parallels Figure \@ref(fig:swe-vowels-by-quantity) and illustrates the effect of considering formant movements for neighboring categories. As visualized in Figure \@ref(fig:trajectory-ellipses), the overlap between [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("oː")`] is substantially reduced at the later time-points, while [`r linguisticsdown::cond_cmpl("ɛː")`]-[`r linguisticsdown::cond_cmpl("æː")`], [`r linguisticsdown::cond_cmpl("øː")`]-[`r linguisticsdown::cond_cmpl("œː")`] and [`r linguisticsdown::cond_cmpl("ø")`]-[`r linguisticsdown::cond_cmpl("œ")`] are most distinguishable at earlier time-points.

(ref:trajectory-ellipses) Vowel placement in F1-F2 space at each of the five time-points. Ellipses show bivariate Gaussian 95% confidence interval of vowel means at each of the five time-points. Transparency indicates time-point, more transparent ellipses for earlier times. The vowel label is placed at vowel mid-point (50%). The arrow indicates the direction of the formant trajectory and ends at the final time-point, at 80% into the vowel.

```{r trajectory-ellipses, fig.width=base.width*3, fig.height=base.height*2, out.width='90%', fig.align='center', fig.cap="(ref:trajectory-ellipses)"}
d.SwehVd.forStudy.long.dynamic %>%
  # Filter down to test folds
  filter(Normalization.Type == "Nearey's uniform scaling (log)") %>%
  mutate(timepoint = as.character(timepoint)) %>%
  group_by(Normalization.Type, Talker, category, timepoint, Quantity) %>%
  summarise(across(c(F1, F2), ~mean(.x))) %>%
  ggplot(
    aes(
      x = F2, 
      y = F1,
      group = NULL,
      color = category,
      #linetype = timepoint,
      alpha = timepoint)) +
  stat_ellipse(
    mapping = aes(
      colour = category)) +
  # Add between-talker mean
  geom_path(
    data = . %>%
      group_by(category, timepoint, Quantity) %>%
      summarise(across(c(F1, F2), ~mean(.x))),
    alpha = .7,
    arrow = arrow(ends = "last", type = "closed", angle = "22.5", length = unit(.2, "cm")),
    size = .75) +
  geom_label(
    data =
      d.SwehVd.forStudy.long.dynamic %>%
      filter(Normalization.Type == "Nearey's uniform scaling (log)", timepoint == 50) %>%
      mutate(timepoint = as.character(timepoint))  %>%
      group_by(Normalization.Type, Talker, category, timepoint, Quantity) %>%
      summarise(across(c(F1, F2), ~mean(.x))) %>%
      group_by(category, Quantity, Normalization.Type, timepoint) %>%
      summarise(across(c(F1, F2), ~ mean(.x))),
    mapping = aes(
      colour = category,
      label = category,
      fontface = ifelse(Quantity == "long", 2, 1)),
    alpha = .6,
    size = 4,
    label.size = NA,
    label.padding = unit(.06, "cm")) +
  scale_colour_manual(name = "category", values = colors.vowel.swe) +
  scale_alpha_manual(values = seq(.15:.75, by = .15), name = "time-point") +
  scale_x_reverse("F2", position = "top", scales::pretty_breaks(n = 4)) +
  scale_y_reverse("F1", position = "right", scales::pretty_breaks(n = 4)) +
  guides(color = "none", shape = "none") +
  facet_grid(factor(Normalization.Type, levels = labels.normalization) ~ Quantity) +
  theme(legend.position = "bottom")
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

### Models of formant dynamics
#### The effect of modeling formant dynamics for neighboring contrasts
The first set of GAMMs were modeled separately for each cue (F1, F2, F3) and each of the sets of neighboring vowels hypothesized to (at least for some talkers) rely on formant dynamics [@fant1971; @kuronen2000; @pelzer-boersma2019]: the high front vowel contrasts [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] - [`r linguisticsdown::cond_cmpl("eː")`] and the short counterpart [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], the high back vowel contrast [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("uː")`] and its short counterpart [`r linguisticsdown::cond_cmpl("ɔ")`] - [`r linguisticsdown::cond_cmpl("ʊ")`], the lower-mid front contrast [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`] and short [`r linguisticsdown::cond_cmpl("ɛ")`] - [`r linguisticsdown::cond_cmpl("æ")`], and the mid center [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("œː")`] and [`r linguisticsdown::cond_cmpl("ø")`] - [`r linguisticsdown::cond_cmpl("œ")`]. Summary tables of models are included in the SI, Section \@ref(sec:SI-GAMMs).

```{r}
# Run GAMMs predicting F1, F2, F3 separately for subsets of neighboring contrasts
# Dataframe for running GAMMs on high front vowels
d.model.front.long.Y <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[iː]", "[yː]")) %>%
  mutate(
    category = factor(category, levels = c("[iː]", "[yː]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.front.long.U <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[iː]", "[ʉː]")) %>%
  mutate(
    category = factor(category, levels = c("[iː]", "[ʉː]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.front.long.E <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[iː]", "[eː]")) %>%
  mutate(
    category = factor(category, levels = c("[iː]", "[eː]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Dataframe for running GAMMs on high back vowels
d.model.back.long <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[oː]", "[uː]")) %>%
  mutate(
    category = factor(category, levels = c("[oː]", "[uː]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Dataframe for running GAMMs on low front vowels
d.model.center.long <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɛː]", "[æː]")) %>%
  mutate(
    category = factor(category, levels = c("[ɛː]", "[æː]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Dataframe for running GAMMs on mid center vowels
d.model.mid.long <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[øː]", "[œː]")) %>%
  mutate(
    category = factor(category, levels = c("[øː]", "[œː]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Dataframe for running GAMMs on high front short vowels
d.model.front.short <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɪ]", "[ʏ]")) %>%
  mutate(
    category = factor(category, levels = c("[ɪ]", "[ʏ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Dataframe for running GAMMs on high back vowels
d.model.back.short <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɔ]", "[ʊ]")) %>%
  mutate(
    category = factor(category, levels = c("[ɔ]", "[ʊ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Dataframe for running GAMMs on low front vowels
d.model.center.short <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɛ]", "[æ]")) %>%
  mutate(
    category = factor(category, levels = c("[ɛ]", "[æ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Dataframe for running GAMMs on mid center vowels
d.model.mid.short <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ø]", "[œ]")) %>%
  mutate(
    category = factor(category, levels = c("[ø]", "[œ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Difference code the vowel variable
#front vowels
d.model.front.long.Y$categoryO <- as.ordered(d.model.front.long.Y$category)
contrasts(d.model.front.long.Y$categoryO) <- contr.treatment(2)

d.model.front.long.U$categoryO <- as.ordered(d.model.front.long.U$category)
contrasts(d.model.front.long.U$categoryO) <- contr.treatment(2)

d.model.front.long.E$categoryO <- as.ordered(d.model.front.long.E$category)
contrasts(d.model.front.long.E$categoryO) <- contr.treatment(2)

d.model.front.short$categoryO <- as.ordered(d.model.front.short$category)
contrasts(d.model.front.short$categoryO) <- contr.treatment(2)
#back vowels
d.model.back.long$categoryO <- as.ordered(d.model.back.long$category)
contrasts(d.model.back.long$categoryO) <- contr.treatment(2)

d.model.back.short$categoryO <- as.ordered(d.model.back.short$category)
contrasts(d.model.back.short$categoryO) <- contr.treatment(2)
#center vowels
d.model.center.long$categoryO <- as.ordered(d.model.center.long$category)
contrasts(d.model.center.long$categoryO) <- contr.treatment(2)

d.model.center.short$categoryO <- as.ordered(d.model.center.short$category)
contrasts(d.model.center.short$categoryO) <- contr.treatment(2)
#mid vowels
d.model.mid.long$categoryO <- as.ordered(d.model.mid.long$category)
contrasts(d.model.mid.long$categoryO) <- contr.treatment(2)

d.model.mid.short$categoryO <- as.ordered(d.model.mid.short$category)
contrasts(d.model.mid.short$categoryO) <- contr.treatment(2)

# Rename contrast labels
d.model.front.long.Y$categoryO <- factor(d.model.front.long.Y$categoryO, labels = c("[iː]", "[yː]"))
d.model.front.long.U$categoryO <- factor(d.model.front.long.U$categoryO, labels = c("[iː]", "[ʉː]"))
d.model.front.long.E$categoryO <- factor(d.model.front.long.E$categoryO, labels = c("[iː]", "[eː]"))
d.model.front.short$categoryO <- factor(d.model.front.short$categoryO, labels = c("[ɪ]", "[ʏ]"))
d.model.back.long$categoryO <- factor(d.model.back.long$categoryO, labels = c("[oː]", "[uː]"))
d.model.back.short$categoryO <- factor(d.model.back.short$categoryO, labels = c("[ɔ]", "[ʊ]"))
d.model.center.long$categoryO <- factor(d.model.center.long$categoryO, labels = c("[ɛː]", "[æː]"))
d.model.center.short$categoryO <- factor(d.model.center.short$categoryO, labels = c("[ɛ]", "[æ]"))
d.model.mid.long$categoryO <- factor(d.model.mid.long$categoryO, labels = c("[øː]", "[œː]"))
d.model.mid.short$categoryO <- factor(d.model.mid.short$categoryO, labels = c("[ø]", "[œ]"))
```
```{r}
# Run all gamms for front vowels
m.F1.front.long.Y.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.Y)

m.F2.front.long.Y.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.Y)

m.F3.front.long.Y.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.Y)

m.F1.front.long.U.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.U)

m.F2.front.long.U.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.U)

m.F3.front.long.U.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.U)

m.F1.front.long.E.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.E)

m.F2.front.long.E.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.E)

m.F3.front.long.E.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.long.E)

m.F1.front.short.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.short)

m.F2.front.short.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.short)

m.F3.front.short.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.front.short)
```
```{r}
# Run all gamms for back vowels
m.F1.back.long.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.back.long)

m.F2.back.long.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.back.long)

m.F3.back.long.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.back.long)

m.F1.back.short.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.back.short)

m.F2.back.short.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.back.short)

m.F3.back.short.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.back.short)
```
```{r}
# Run all gamms for center vowels
m.F1.center.long.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.center.long)

m.F2.center.long.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.center.long)

m.F3.center.long.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.center.long)

m.F1.center.short.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.center.short)

m.F2.center.short.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.center.short)

m.F3.center.short.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.center.short)
```
```{r}
# Run all gamms for mid vowels
m.F1.mid.long.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.mid.long)

m.F2.mid.long.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.mid.long)

m.F3.mid.long.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.mid.long)

m.F1.mid.short.ord <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.mid.short)

m.F2.mid.short.ord <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.mid.short)

m.F3.mid.short.ord <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.mid.short)
```

The GAMMs fit to the high front vowel contrasts suggested significant constant and non-linear differences over time between vowels in each contrast for all cues and contrasts (for constant differences, all $ps < .0001$; for non-linear differences, all $ps < .039$), except for [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] predicting F3 ($\hat\beta = -.002, SE = .01, p > .84$), and [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] predicting F1 ($\hat\beta = .007, SE = .007, p > .27$) (Figures \@ref(fig:m-high-front-I-Y) and \@ref(fig:m-high-front-I-U-E)). This suggests that there are no differences in F3 for [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] or in F1 for [`r linguisticsdown::cond_cmpl("ɪ")`] and [`r linguisticsdown::cond_cmpl("ʏ")`] when formant dynamics are considered. While F3 increases separability between [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] under static analysis, the *dynamics* in F3 does not seem to add information about vowel quality for this contrast.

(ref:m-high-front-I-Y) Fitted smooths of GAMM for predicting F1 (**upper row**), F2 (**mid row**), F3 (**bottom row**) and 95% confidence intervals for the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] contrast (**left**), and the [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] contrast (**right**). Differences significantly different from 0 are marked by black dotted vertical lines.

```{r m-high-front-I-Y, message=FALSE, fig.width=base.width*4.5, fig.height=base.height*4.5, fig.align='center', fig.cap="(ref:m-high-front-I-Y)"}
par(mfrow=c(3,2))
plot_diff(m.F1.front.long.Y.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[yː]")), print.summary = F, col = "#FC8D62", hide.label = T, main = "A", col.diff = "black")
plot_diff(m.F1.front.short.ord, view = "timepoint", comp = list(categoryO = c("[ɪ]", "[ʏ]")), print.summary = F, col = "#D95F02", hide.label = T, main = "B", col.diff = "black")
plot_diff(m.F2.front.long.Y.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[yː]")), print.summary = F, col = "#FC8D62",hide.label = T, main = "C", col.diff = "black")
plot_diff(m.F2.front.short.ord, view = "timepoint", comp = list(categoryO = c("[ɪ]", "[ʏ]")), print.summary = F, col = "#D95F02", hide.label = T, main = "D", col.diff = "black")
plot_diff(m.F3.front.long.Y.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[yː]")), print.summary = F, col = "#FC8D62", hide.label = T, main = "E", col.diff = "black")
plot_diff(m.F3.front.short.ord, view = "timepoint", comp = list(categoryO = c("[ɪ]", "[ʏ]")), print.summary = F, col = "#D95F02", hide.label = T, main = "F", col.diff = "black")
#plot_diff(m.F1.front.long, view = "timepoint", comp = list(category = c("[iː]", "[yː]")))
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```
(ref:m-high-front-I-U-E) Fitted smooths of GAMM for predicting F1 (**upper row**), F2 (**mid row**), F3 (**bottom row**) and 95% confidence intervals for the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] contrast (**left**), and the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("eː")`] contrast (**right**). Differences significantly different from 0 are marked by black dotted vertical lines.

```{r m-high-front-I-U-E, message=FALSE, fig.width=base.width*4.5, fig.height=base.height*4.5, fig.align='center', fig.cap="(ref:m-high-front-I-U-E)"}
par(mfrow=c(3,2))
plot_diff(m.F1.front.long.U.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[ʉː]")), print.summary = F, col = "#8DA0CB", hide.label = T, main = "A", col.diff = "black")
plot_diff(m.F1.front.long.E.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[eː]")), print.summary = F, col = "#FB9A99", hide.label = T, main = "B", col.diff = "black")
plot_diff(m.F2.front.long.U.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[ʉː]")), print.summary = F, col = "#8DA0CB",hide.label = T, main = "C", col.diff = "black")
plot_diff(m.F2.front.long.E.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[eː]")), print.summary = F, col = "#FB9A99", hide.label = T, main = "D", col.diff = "black")
plot_diff(m.F3.front.long.U.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[ʉː]")), print.summary = F, col = "#8DA0CB", hide.label = T, main = "E", col.diff = "black")
plot_diff(m.F3.front.long.E.ord, view = "timepoint", comp = list(categoryO = c("[iː]", "[eː]")), print.summary = F, col = "#FB9A99", hide.label = T, main = "F", col.diff = "black")
#plot_diff(m.F1.front.long, view = "timepoint", comp = list(category = c("[iː]", "[yː]")))
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```
Significant constant as well as non-linear effects of category on all three cues was found in all GAMMs fit to the high back long and short contrasts (for constant differences, all $ps < .0001$; for non-linear differences, all $ps < .0197$). These results suggest that all three cues contribute to distinguishing between these vowels also when formant dynamics are considered (Figure \@ref(fig:m-high-back)).

(ref:m-high-back) Fitted smooths of GAMM for predicting F1 (**upper row**), F2 (**mid row**), F3 (**bottom row**) and 95% confidence intervals for the [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("uː")`] contrast (**left**), and the [`r linguisticsdown::cond_cmpl("ɔ")`] - [`r linguisticsdown::cond_cmpl("ʊ")`] contrast (**right**). Differences significantly different from 0 are marked by black dotted vertical lines.

```{r m-high-back, message=FALSE, fig.width=base.width*4.5, fig.height=base.height*4.5, fig.align='center', fig.cap="(ref:m-high-back)"}
par(mfrow=c(3,2))
plot_diff(m.F1.back.long.ord, view = "timepoint", comp = list(categoryO = c("[oː]", "[uː]")), print.summary = F, col = "#A6CEE3", hide.label = T, main = "A", col.diff = "black")
plot_diff(m.F1.back.short.ord, view = "timepoint", comp = list(categoryO = c("[ɔ]", "[ʊ]")), print.summary = F, col = "#1F78B4", hide.label = T, main = "B", col.diff = "black")
plot_diff(m.F2.back.long.ord, view = "timepoint", comp = list(categoryO = c("[oː]", "[uː]")), print.summary = F, col = "#A6CEE3", hide.label = T, main = "C", col.diff = "black")
plot_diff(m.F2.back.short.ord, view = "timepoint", comp = list(categoryO = c("[ɔ]", "[ʊ]")), print.summary = F, col = "#1F78B4", hide.label = T, main = "D", col.diff = "black")
plot_diff(m.F3.back.long.ord, view = "timepoint", comp = list(categoryO = c("[oː]", "[uː]")), print.summary = F, col = "#A6CEE3", hide.label = T, main = "E", col.diff = "black")
plot_diff(m.F3.back.short.ord, view = "timepoint", comp = list(categoryO = c("[ɔ]", "[ʊ]")), print.summary = F, col = "#1F78B4", hide.label = T, main = "F", col.diff = "black")
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```
The GAMMs fit to the lower-mid front long and short vowel contrasts suggested constant and non-linear effects of vowel on F1 and F2 (for constant differences, all $ps < .0001$; for non-linear differences, all $ps < .0002$). For F3, there were no significant constant differences between [`r linguisticsdown::cond_cmpl("ɛː")`] and [`r linguisticsdown::cond_cmpl("æː")`] ($\hat\beta = -.006, SE = .007, p > .37$), and no constant or non-linear differences between [`r linguisticsdown::cond_cmpl("ɛ")`] and [`r linguisticsdown::cond_cmpl("æ")`] ($\hat\beta = .0099, SE = .005, p > .073$; $EDF = 1, F = .879, p > .348$). Figure \@ref(fig:m-center) demonstrates how these vowels overlap in F3-dynamics, but are distinguished for most of the segment along F1 and F2.

(ref:m-center) Fitted smooths of GAMM for predicting F1 (**upper row**), F2 (**mid row**), F3 (**bottom row**) and 95% confidence intervals for the [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`] contrast (**left**), and the [`r linguisticsdown::cond_cmpl("ɛ")`] - [`r linguisticsdown::cond_cmpl("æ")`] contrast (**right**). Differences significantly different from 0 are marked by black dotted vertical lines.

```{r m-center, message=FALSE, fig.width=base.width*4.5, fig.height=base.height*4.5, fig.align='center', fig.cap="(ref:m-center)"}
par(mfrow=c(3,2))
plot_diff(m.F1.center.long.ord, view = "timepoint", comp = list(categoryO = c("[ɛː]", "[æː]")), print.summary = F, col = "#E78AC3", hide.label = T, main = "A", col.diff = "black")
plot_diff(m.F1.center.short.ord, view = "timepoint", comp = list(categoryO = c("[ɛ]", "[æ]")), print.summary = F, col = "#E7298A", hide.label = T, main = "B", col.diff = "black")
plot_diff(m.F2.center.long.ord, view = "timepoint", comp = list(categoryO = c("[ɛː]", "[æː]")), print.summary = F, col = "#E78AC3", hide.label = T, main = "C", col.diff = "black")
plot_diff(m.F2.center.short.ord, view = "timepoint", comp = list(categoryO = c("[ɛ]", "[æ]")), print.summary = F, col = "#E7298A", hide.label = T, main = "D", col.diff = "black")
plot_diff(m.F3.center.long.ord, view = "timepoint", comp = list(categoryO = c("[ɛː]", "[æː]")), print.summary = F, col = "#E78AC3", hide.label = T, main = "E", col.diff = "black")
plot_diff(m.F3.center.short.ord, view = "timepoint", comp = list(categoryO = c("[ɛ]", "[æ]")), print.summary = F, col = "#E7298A", hide.label = T, main = "F", col.diff = "black")
```

For the GAMMs fit to the mid center vowels, there was an effect of category on all cue evaluations for both long and short vowels (for constant differences, all $ps < .048$; for non-linear differences, all $ps < .0001$; Figure \@ref(fig:m-mid)), with the exception of both long and short vowels fit to F1, for which no constant difference was found (for [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("œː")`], $\hat\beta = -.0098, SE = .007, p > .18$; for [`r linguisticsdown::cond_cmpl("ø")`] - [`r linguisticsdown::cond_cmpl("œ")`], $\hat\beta = -.016, SE = .0097, p > .102$). These contrasts nevertheless displayed non-linear differences over time (Figure \@ref(fig:m-mid)). These results would seem to suggest that when formant dynamics are considered, F1 does not carry information about vowel quality for the [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("œ")`] and [`r linguisticsdown::cond_cmpl("ø")`] - [`r linguisticsdown::cond_cmpl("œː")`] contrasts. However, the vowels within each pair display different non-linear patterns.

(ref:m-mid) Fitted smooths of GAMM for predicting F1 (**upper row**), F2 (**mid row**), F3 (**bottom row**) and 95% confidence intervals for the [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("œː")`] contrast (**left**), and the [`r linguisticsdown::cond_cmpl("ø")`] - [`r linguisticsdown::cond_cmpl("œ")`] contrast (**right**). Differences significantly different from 0 are marked by black dotted vertical lines.

```{r m-mid, message=FALSE, fig.width=base.width*4.5, fig.height=base.height*4.5, fig.align='center', fig.cap="(ref:m-mid)"}
par(mfrow=c(3,2))
plot_diff(m.F1.mid.long.ord, view = "timepoint", comp = list(categoryO = c("[øː]", "[œː]")), print.summary = F, col = "#FFD92F", hide.label = T, main = "A", col.diff = "black")
plot_diff(m.F1.mid.short.ord, view = "timepoint", comp = list(categoryO = c("[ø]", "[œ]")), print.summary = F, col = "#E6AB02", hide.label = T, main = "B", col.diff = "black")
plot_diff(m.F2.mid.long.ord, view = "timepoint", comp = list(categoryO = c("[øː]", "[œː]")), print.summary = F, col = "#FFD92F", hide.label = T, main = "C", col.diff = "black")
plot_diff(m.F2.mid.short.ord, view = "timepoint", comp = list(categoryO = c("[ø]", "[œ]")), print.summary = F, col = "#E6AB02", hide.label = T, main = "D", col.diff = "black")
plot_diff(m.F3.mid.long.ord, view = "timepoint", comp = list(categoryO = c("[øː]", "[œː]")), print.summary = F, col = "#FFD92F", hide.label = T, main = "E", col.diff = "black")
plot_diff(m.F3.mid.short.ord, view = "timepoint", comp = list(categoryO = c("[ø]", "[œ]")), print.summary = F, col = "#E6AB02", hide.label = T, main = "F", col.diff = "black")
#ggsave(file = "../../figures/p.png", width = 9, height = 5, dpi=1200)
```

Finally, an effect of gender was found in two contrasts predicting F1: [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] ($\hat\beta = -.075, SE = .026, p < .004$), and [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] ($\hat\beta = -.06, SE = .024, p < .01$), indicating a difference in vowel height between female and male talkers. This suggests that the normalization approach likely reduced some talker-specificity related to anatomical differences, but not all. An alternative explanation is that the overall difference in height for these vowels when formant dynamics is considered could be attributed to a real pronunciation difference, driven by sociolinguistic factors [for research on young female talkers driving language change, see e.g., @boberg2019; @labov1990; for a review, see e.g., @woods1997].

The sets of neighboring contrasts investigated here all exhibited varying degrees of category overlap in static analysis. However, when formant dynamics was considered, the vowels in each contrast were all significantly different from each other along at least two cues [c.f., @fant1971; @kuronen2000; @pelzer-boersma2019]. For some contrasts, the vowels overlapped only in parts of the segment, as indicated by the gaps in significant differences in Figures \@ref(fig:m-high-front-I-U-E)**A-B-D-F**, \@ref(fig:m-high-back)**A-C-D-E**, \@ref(fig:m-center)**A-C-E**, \@ref(fig:m-mid)**A-B-E-F**. This indicates that category overlap found in static analysis is mitigated once temporal analysis is included, which suggests that category distinctions unfold over time. The results further indicated that vowel differences in dynamics were driven by both constant as well as non-linear differences in most cases. The contrasts for which no non-linear differences were found were [`r linguisticsdown::cond_cmpl("ɛ")`] - [`r linguisticsdown::cond_cmpl("æ")`] along F3 ($\hat\beta = .0099, SE = .005, p > .073$; $EDF = 1, F = .88, p > .34$), [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] along F1 ($EDF = 1.8, F = 1.06, p > .4$) and F2 ($EDF = 1.59, F = 1.0, p > .43$), and [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] along F2 ($EDF = 1, F = 3.14, p > .076$), which would seem to suggest their similarity in formant movements across the segment.

```{r}
rm(d.model.front.long.ord, d.model.front.short.ord, d.model.back.long.ord, d.model.back.short.ord, d.model.center.long.ord, d.model.center.short.ord)
```
```{r}
# CODE KEPT FROM DISCUSSIONS W M GUBIAN??
# d.model <- d.SwehVd.forStudy.long.static %>%
#   filter(Normalization.Type %in% c("no normalization (Hz)", "Nearey2 (log)")) %>%
#   mutate(across(c(Quantity, category), factor))

# model.F3 <- glmer(category ~ F3 + (1 | Talker), family = binomial, data = d.model %>% filter(Normalization.Type == "no normalization (Hz)"))
# summary(model.F3)

# mgcv
# F3 ~ category + s(timepoint, by = category). ----corresponds to a simple lmr without random factors.
# s = smooth
# bam(F3 ~ category  + s(timepoint, by = category, k = 5))
# k = max degrees of freedom, base curves
# plot_smooth(m1, view = "timepoint", plot_all = "category")
# plot_diff(m1, view = "timepoint", comp = list(category = c())

# Model all cues
# d.model.all.cues <- d.SwehVd %>%
#   filter(Transcribed_vowel == "targeted") %>%
#   mutate(across(c(Talker, category), ~ factor(.x)),
#          across(starts_with("F"), ~ log(.x), .names = "{.col}_log"))
# 
# contrasts(d.model.all.cues$category) <- MASS::contr.sdif(21)
# m <- lmerTest::lmer(F2~ timepoint + (1 + timepoint | Talker), data = d.SwehVd %>% filter(category == "[iː]", Transcribed_vowel == "targeted"))
# summary(m)

# It needs to be a multinomial log regression if predicting vowel from cues
# m.allcues <- mgcv::bam(category ~ s(F0_log) + s(F1_log) + s(F2_log) + s(F3_log) + s(timepoint, by = category, k = 5) + s(1 | Talker), 
#                    data = d.model.all.cues, family = "multinomial")
#summary(m.allcues)
#ggeffects::ggpredict(model.cues, "F0 [all]") %>% plot()

# m.allcues.2 <- mgcv::bam(category ~ F0_log + F1_log + F2_log + F3_log + Duration + s(timepoint, by = category, k = 5), data = d.model.all.cues)
# summary(m1)

# plot_smooth(m.F1, view = "timepoint")
# plot_diff(m.F1, view = "timepoint", comp=list(category=c("[ʉː]", "[ʊ]")))

# m.all <- mgcv::gam(list(category ~ F1 + F2 + F3 + Duration + s(timepoint, by = category, k = 5)
#                         + s(Talker, bs = "re"),
#                         ~ F1 + F2 + F3 + Duration + s(timepoint, by = category, k = 5)
#                         + s(Talker, bs = "re")), data = d.model.1, family = multinom(K = 2))
# m.all <- mgcv::gam(list(category ~ s(F1) + s(F2) + s(F3),
#                         ~ s(F1) + s(F2) + s(F3)), family = multinom(K=2), data = d.model)

# d.SwehVd.forStudy.long.static %>%
#   select(-starts_with("formant")) %>%
#   #filter(F3 > .25) %>%
#   filter(Normalization.Type == "Nearey's uniform scaling (log)") %>%
#   mutate(
#     rounding = case_when(category %in% c("[ɵ]", "[ʉː]", "[ʊ]", "[uː]") ~ "inrounded",
#                          category %in% c("[ʏ]", "[yː]", "[ø]", "[øː]", "[ɔ]", "[oː]") ~ "outrounded",
#                          TRUE ~ "no rounding")) %>%
#   ggplot(
#     aes(F3, fill = factor(category))) +
#   geom_density(alpha = .5) +
#   theme(legend.position = "none") +
#   scale_colour_manual(name = "category", values = colors.vowel.swe, aesthetics = c("colour", "fill")) +
#   guides(linetype = "none", color = "none", fill = "none") +
#   facet_wrap(factor(rounding, levels = c("inrounded", "outrounded", "no rounding")) ~ Quantity, ncol = 2)
```

#### Formant dynamics in long-short vowel pairs
The second set of GAMMs modeled the effect of category on F1, F2, and F3 for all long and short vowel pairs. Summary tables and visualizations of these GAMMs are included in the SI (Section \@ref(sec:SI-GAMMs)). There was a treatment effect of vowel on all spectral cues for all vowel pairs, driven by both constant (for F1, all $ps < .0067$; for F2, all $ps < .002$, for F3, all $ps < .022$) and non-linear differences (for F1, all $ps < .0004$; for F2, all $ps < .016$, for F3, all $ps < .05$), except for [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("ɛ")`] ($\hat\beta = .00003, SE = .008, p > .96$) and [`r linguisticsdown::cond_cmpl("ɑː")`] - [`r linguisticsdown::cond_cmpl("a")`] ($\hat\beta = -.0043, SE = .01, p > .67$; $EDF = 2.09, F = 1.67, p > .19$) predicting F3. This would thus seem to suggest that F3 does not reliably distinguish between long-short vowels in these pairs when dynamics is considered. Differences in dynamics were overall driven by both constant and non-linear differences. However, some vowel pairs displayed insignificant smooth differences between vowels within pairs, suggesting similarity in formant movements across the segment (for the [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("ʊ")`] contrast predicting F2, the [`r linguisticsdown::cond_cmpl("æː")`] - [`r linguisticsdown::cond_cmpl("æ")`] contrast predicting F1 and F3, and the [`r linguisticsdown::cond_cmpl("œː")`] - [`r linguisticsdown::cond_cmpl("œ")`] contrast predicting F3, all $ps > .06$). With the exception of the [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] vowel pair, all rounded vowels displayed lower F3 values in their long allophones, presumably indicating greater lip-rounding as caused by more vigorous activity of the lips [e.g., @hadding1976; @stalhammar1973]. Again, significant gender differences were found in height for some high vowels (for the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("ɪ")`], [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] and [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("ɔ")`] contrasts predicting F1, all $ps < .0086$), but also in backness (F2) for the [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("ʊ")`] contrast ($p < .0185$).

The results suggest that when formant dynamics are considered, *all* long-short Central Swedish vowel pairs differ in spectral cues. Among the pairs that displayed smaller, albeit statistically significant, differences in spectral cues is the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("ɪ")`] pair predicting F1, possibly indicating a tendency for stronger duration dependency, in line with previous perceptual work [@behne-kirk1997]. Overall, larger effects were found for F2 which would support the hypothesis that F2 carries more of the durational variation in quantity contrasts in Swedish. Non-significant differences within pairs were found only for GAMMs predicting F3, which highlights the primary importance of F1-F2 as spectral cues to quantity contrasts under the assumption of formant dynamics.

```{r}
# Dataframes for GAMMs on all vowel pairs
d.model.I <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[iː]", "[ɪ]")) %>%
  mutate(
    category = factor(category, levels = c("[iː]", "[ɪ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.Y <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[yː]", "[ʏ]")) %>%
  mutate(
    category = factor(category, levels = c("[yː]", "[ʏ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.U <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ʉː]", "[ɵ]")) %>%
  mutate(
    category = factor(category, levels = c("[ʉː]", "[ɵ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.E <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[eː]", "[ɛ]")) %>%
  mutate(
    category = factor(category, levels = c("[eː]", "[ɛ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.Ä <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɛː]", "[ɛ]")) %>%
  mutate(
    category = factor(category, levels = c("[ɛː]", "[ɛ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.ÄR <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[æː]", "[æ]")) %>%
  mutate(
    category = factor(category, levels = c("[æː]", "[æ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.Ö <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[øː]", "[ø]")) %>%
  mutate(
    category = factor(category, levels = c("[øː]", "[ø]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.ÖR <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[œː]", "[œ]")) %>%
  mutate(
    category = factor(category, levels = c("[œː]", "[œ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.A <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[ɑː]", "[a]")) %>%
  mutate(
    category = factor(category, levels = c("[ɑː]", "[a]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.Å <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[oː]", "[ɔ]")) %>%
  mutate(
    category = factor(category, levels = c("[oː]", "[ɔ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

d.model.O <- d.SwehVd.forStudy.long.dynamic %>%
  select(-starts_with("formant")) %>%
  filter(Normalization.Type == "Nearey's uniform scaling (log)", category %in% c("[uː]", "[ʊ]")) %>%
  mutate(
    category = factor(category, levels = c("[uː]", "[ʊ]"))) %>%
  mutate(across(c(Talker, Quantity, Gender), ~ factor(.x)))

# Difference code the vowel variable
d.model.I$categoryO <- as.ordered(d.model.I$category)
contrasts(d.model.I$categoryO) <- contr.treatment(2)

d.model.Y$categoryO <- as.ordered(d.model.Y$category)
contrasts(d.model.Y$categoryO) <- contr.treatment(2)

d.model.U$categoryO <- as.ordered(d.model.U$category)
contrasts(d.model.U$categoryO) <- contr.treatment(2)

d.model.E$categoryO <- as.ordered(d.model.E$category)
contrasts(d.model.E$categoryO) <- contr.treatment(2)

d.model.Ä$categoryO <- as.ordered(d.model.Ä$category)
contrasts(d.model.Ä$categoryO) <- contr.treatment(2)

d.model.ÄR$categoryO <- as.ordered(d.model.ÄR$category)
contrasts(d.model.ÄR$categoryO) <- contr.treatment(2)

d.model.Ö$categoryO <- as.ordered(d.model.Ö$category)
contrasts(d.model.Ö$categoryO) <- contr.treatment(2)

d.model.ÖR$categoryO <- as.ordered(d.model.ÖR$category)
contrasts(d.model.ÖR$categoryO) <- contr.treatment(2)

d.model.A$categoryO <- as.ordered(d.model.A$category)
contrasts(d.model.A$categoryO) <- contr.treatment(2)

d.model.Å$categoryO <- as.ordered(d.model.Å$category)
contrasts(d.model.Å$categoryO) <- contr.treatment(2)

d.model.O$categoryO <- as.ordered(d.model.O$category)
contrasts(d.model.O$categoryO) <- contr.treatment(2)

```
```{r}
# run all models for all cues and all pairs
m.F1.I <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.I)
m.F2.I <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.I)
m.F3.I <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.I)
# Y
m.F1.Y <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Y)
m.F2.Y <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Y)
m.F3.Y <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Y)
# U
m.F1.U <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.U)
m.F2.U <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.U)
m.F3.U <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.U)
#E
m.F1.E <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.E)
m.F2.E <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.E)
m.F3.E <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.E)
#Ä
m.F1.Ä <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Ä)
m.F2.Ä <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Ä)
m.F3.Ä <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Ä)
#ÄR
m.F1.ÄR <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.ÄR)
m.F2.ÄR <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.ÄR)
m.F3.ÄR <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.ÄR)
#Ö
m.F1.Ö <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Ö)
m.F2.Ö <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Ö)
m.F3.Ö <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Ö)
#ÖR
m.F1.ÖR <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.ÖR)
m.F2.ÖR <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.ÖR)
m.F3.ÖR <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.ÖR)
#A
m.F1.A <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.A)
m.F2.A <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.A)
m.F3.A <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.A)
#Å
m.F1.Å <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Å)
m.F2.Å <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Å)
m.F3.Å <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.Å)
#O
m.F1.O <- mgcv::bam(F1 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.O)
m.F2.O <- mgcv::bam(F2 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.O)
m.F3.O <- mgcv::bam(F3 ~ categoryO + Gender + s(timepoint, k = 5) + s(timepoint, by = categoryO, k = 5)
                                + s(Talker, bs = "re")
                                + s(Talker, categoryO, bs = "re"),
                                data = d.model.O)
```

## Results summary
The results from the static analysis suggest that F1, F2, F3 and duration all contribute to the distinction of Central Swedish vowels. While F1 and F2 are or primary importance for most contrasts, F3 contributes to increasing the separability between neighboring vowels differing in lip-rounding. The static analysis further suggested that while the F1-F2-duration cue combination maximized separability for long-short vowel pairs, the inclusion of F3 also increased separability relative to F1-F2. Importantly, including F3 increased separability more than duration did for the [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] contrast.

Some vowels displayed overlap in the static analysis but increased separability when formant dynamics was considered, as indicated by formant trajectory analysis and GAMMs. The dynamic analyses highlighted that the short vowels also display formant movements, and that for most of both long and short categories, a larger portion of the dynamics resides in the later part of the segment. Given the increased separability of neighboring contrasts found in dynamic analysis, it is reasonable to assume formant movements as an auxiliary cue to vowel identity, more so for some contrasts than others. For instance, the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] - [`r linguisticsdown::cond_cmpl("eː")`], [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("uː")`], [`r linguisticsdown::cond_cmpl("ɔ")`] - [`r linguisticsdown::cond_cmpl("ʊ")`], [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`],  [`r linguisticsdown::cond_cmpl("ɛ")`] - [`r linguisticsdown::cond_cmpl("æ")`], [`r linguisticsdown::cond_cmpl("øː")`] - [`r linguisticsdown::cond_cmpl("œː")`], and [`r linguisticsdown::cond_cmpl("ø")`] - [`r linguisticsdown::cond_cmpl("œ")`] contrasts displayed considerable overlap in static analyses but increased distinguishibility when analysed dynamically. 

While the static analysis suggested increased separability for the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] contrast when F3 was included, the GAMM fit to the same contrast found no significant differences between the two vowels predicting F3, suggesting less distinguishability under the assumption of formant dynamics. However, the GAMM fit to [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`] suggested statistically significant differences between the two categories predicting F3. These two analyses taken together suggest more effects on F3 in the short vowel compared to the long vowel.

\begin{table}
\caption{\label{tab:swehvd-vowels}The phonetic characterization of long (left) and short (right) Central Swedish vowels (as represented in the SwehVd database). Rounded vowels are shaded.}
\centering
\begin{tabular}[t]{c|c|ccc|c}
\hline
&front&\multicolumn{3}{|c|}{central}&back\\
\hline
high&&`r linguisticsdown::cond_cmpl("[iː]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[yː]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[ʉː]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[uː]")`\\
\hline
mid-high&`r linguisticsdown::cond_cmpl("[eː]")`&&&&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[oː]")`\\
\hline
lower-mid&`r linguisticsdown::cond_cmpl("[æː]")`&&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[øː]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[œː]")`&`r linguisticsdown::cond_cmpl("[ɑː]")`\\
\end{tabular}
\hspace{2em}
\begin{tabular}[t]{c|cc|cc|c}
\hline
&\multicolumn{2}{|c|}{front}&\multicolumn{2}{|c|}{central}&back\\
\hline
high&`r linguisticsdown::cond_cmpl("[ɪ]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[ʏ]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[ɵ]")`&&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[ʊ]")`\\
\hline
mid-high&`r linguisticsdown::cond_cmpl("[ɛ]")`&&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[ø]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[œ]")`&\cellcolor[HTML]{DCDCDC}`r linguisticsdown::cond_cmpl("[ɔ]")`\\
\hline
lower-mid&`r linguisticsdown::cond_cmpl("[æ]")`&&`r linguisticsdown::cond_cmpl("[a]")`&&\\
\end{tabular}
\end{table}

The resulting phonetic characteristics of the long and short Central Swedish vowels presented here, is summarized in Table \@ref(tab:swehvd-vowels). Beginning with the long vowels, there are 4 high vowels. The current acoustic description suggests that none of them are front. Instead, [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] group with [`r linguisticsdown::cond_cmpl("ʉː")`] as central vowels, and [`r linguisticsdown::cond_cmpl("uː")`] is back [c.f., @pelzer-boersma2019; @schotz2011].^[Whether [`r linguisticsdown::cond_cmpl("yː")`] can still be considered rounded given the high F3 values, is a question for future research.] There are 2 mid-high vowels---[`r linguisticsdown::cond_cmpl("eː")`] (front) and [`r linguisticsdown::cond_cmpl("oː")`] (back)---and 4 lower-mid vowels, [`r linguisticsdown::cond_cmpl("æː")`] (front), [`r linguisticsdown::cond_cmpl("øː")`], [`r linguisticsdown::cond_cmpl("œː")`] (both central) and [`r linguisticsdown::cond_cmpl("ɑː")`] (back). Given the substantial lowering of [`r linguisticsdown::cond_cmpl("ɛː")`] and its overlap with [`r linguisticsdown::cond_cmpl("æ")`], it is reasonable to assume one long allophone for /`r linguisticsdown::cond_cmpl("ɛ")`/, which is [`r linguisticsdown::cond_cmpl("æː")`] [c.f., @pelzer-boersma2019].

The short vowel space contains 4 high vowels, two of which are front, [`r linguisticsdown::cond_cmpl("ɪ")`] and [`r linguisticsdown::cond_cmpl("ʏ")`], one is central [`r linguisticsdown::cond_cmpl("ɵ")`] and one back [`r linguisticsdown::cond_cmpl("ʊ")`]. There are 4 mid-high vowels, [`r linguisticsdown::cond_cmpl("ɛ")`] (front), [`r linguisticsdown::cond_cmpl("ø")`], [`r linguisticsdown::cond_cmpl("œ")`] (both central), and [`r linguisticsdown::cond_cmpl("ɔ")`] (back), and 2 low vowels, [`r linguisticsdown::cond_cmpl("æ")`] (front), and [`r linguisticsdown::cond_cmpl("a")`] (central). The analysis of this database supports what @riad2014 anticipated and @pelzer-boersma2019 suggested, namely, a vowel system consisting of three height levels only, in contrast to the traditional four height levels system [e.g., @engstrand1999; @riad2014; @engstrand2004]. 

The motivation of the summarized acoustics presented in Table \@ref(tab:swehvd-vowels) rests on a pairwise grouping of the long and short vowels, similar to phonological analyses of Central Swedish [@riad2014]. For instance, despite its high position, [`r linguisticsdown::cond_cmpl("eː")`] is defined as mid-high, on par with [`r linguisticsdown::cond_cmpl("oː")`], as both vowels share diphthongizational patterns, and their short versions are both lower than their long counterparts. Furthermore, [`r linguisticsdown::cond_cmpl("æː")`] is front rather than central as its short version is clearly more front than [`r linguisticsdown::cond_cmpl("ø")`]. Because of their overall centralized positions in SwehVd, [`r linguisticsdown::cond_cmpl("i:")`] and [`r linguisticsdown::cond_cmpl("yː")`] groups with [`r linguisticsdown::cond_cmpl("ʉː")`], while their short versions are still clearly front. One could thus argue that both /`r linguisticsdown::cond_cmpl("i")`/ and /`r linguisticsdown::cond_cmpl("y")`/ are under-specified for the front-back dimension, which would also be the case for /`r linguisticsdown::cond_cmpl("ɑ")`/, as [`r linguisticsdown::cond_cmpl("ɑː")`] is back and [`r linguisticsdown::cond_cmpl("a")`] is central. It is important to note that while Table \@ref(tab:swehvd-vowels) may point to possible updates of Central Swedish vowel phonology, this is only tentative as more evidence is required for a definite update. These include, e.g., more investigations in different contexts.

```{r}
# d.SwehVd %>%
#   filter(Transcribed_vowel == "targeted", Word != "hädd") %>%
#   # Get the geometric mean F1-F2 across the five time points
#   group_by(Talker, category, Token, Quantity) %>%
#   summarise(across(c(F1, F2, F3, Duration), ~ geometric.mean(.x))) %>%
#   plot_ly(
#     x = ~ F2, 
#     y = ~ F3, 
#     z = ~ F1, 
#     color = ~ category) %>%
#     #colors = c("black", "gray"),
#     #size = ~ -Response.Entropy) %>% 
#   add_markers() %>%
#   layout(
#     autoresize = TRUE,
#     showlegend = TRUE,
#     scene = list(
#       xaxis = list(
#         title = "F2 (Hz)",
#         autorange = "reversed"),
#       yaxis = list(
#         title = "F3 (Hz)",
#         autorange = "reversed"),
#       zaxis = list(
#         title = "F1 (Hz)",
#         autorange = "reversed")))
```

# General discussion {#sec:discussion}
The purpose of this paper was to present up-to-date static and dynamic acoustic analyses of Central Swedish vowels that included both empirical formant data and models of formant dynamics. The study thus aimed to expand on and complement previous work by 1) the scope of the analysis, performing the same type of analyses on all 21 categories, 2) the materials chosen, using a recently collected hVd corpus with high resolution within and across talkers for a single variety, and 3) the methodological approach employed, with the use of traditional formant analysis, category separability index, trajectory visualizations and models of formant dynamics (GAMMs). The study further aimed to evaluate the hypothesized importance of F3 for contrasting rounded vs. unrounded categories, the extent to which *all* long-short vowel pairs display spectral differences, and what part of the vowel space is more susceptible to diphthongization. Next, the main findings are discussed, alongside methodological considerations and future directions.

Beginning with the static analysis, the results seem to suggest that the most important cues to vowel identity are F1, F2 and duration, which replicates previous work [e.g., @kuronen2000; @lindblom1963]. Including F3 increased separability for all rounding contrasts which suggests that F3 adds information for rounding vs. unrounded neighboring contrasts, given the way category separability is calculated here. The category separability index for the long-short vowel pairs suggested that the F1-F2-duration cue combination maximized separability between vowels within pairs, highlighting the role of both spectral and temporal cues for quantity contrasts and that *all* long-short vowel pairs display spectral differences. The results further indicated that F2 seemed to carry more of the spectral variation in quantity contrasts [@kuronen2000; @lindblom1963]. Of note, however, one long-short vowel pair, [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], achieved higher separability with F3-inclusion over Duration-inclusion, despite the fact that the two vowels clearly display systematic differences in duration similar to all other pairs (Figure \@ref(fig:duration-densities)). Across talkers, [`r linguisticsdown::cond_cmpl("ʏ")`] is clearly more front than [`r linguisticsdown::cond_cmpl("yː")`] (mean F2 for [`r linguisticsdown::cond_cmpl("ʏ")`] = `r round(d.SwehVd.forStudy.long.static %>% filter(category == "[ʏ]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(mean(F2, na.rm = T)) %>% pull(), digits = 0)` Hz, SD=`r round(d.SwehVd.forStudy.long.static %>% filter(category == "[ʏ]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(sd(F2)) %>% pull(), digits = 0)`; mean F2 for [`r linguisticsdown::cond_cmpl("yː")`] = `r round(d.SwehVd.forStudy.long.static %>% filter(category == "[yː]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(mean(F2)) %>% pull(), digits = 0)` Hz, SD=`r round(d.SwehVd.forStudy.long.static %>% filter(category == "[yː]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(sd(F2)) %>% pull(), digits = 0)`), yet F3 is overall higher for [`r linguisticsdown::cond_cmpl("yː")`] (mean F3 for [`r linguisticsdown::cond_cmpl("yː")`] = `r round(d.SwehVd.forStudy.long.static %>% filter(category == "[yː]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(mean(F3)), digits = 0)` Hz, SD=`r round(d.SwehVd.forStudy.long.static %>% filter(category == "[yː]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(sd(F3)), digits = 0)`; mean F3 for [`r linguisticsdown::cond_cmpl("ʏ")`] = `r round(d.SwehVd.forStudy.long.static %>% filter(category == "[ʏ]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(mean(F3)) %>% pull(), digits = 0)` Hz, SD=`r round(d.SwehVd.forStudy.long.static %>% filter(category == "[ʏ]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(sd(F3)) %>% pull(), digits = 0)`). Under the assumption of a lower F3 in high front rounded vowels being indicative of increased lip-rounding (compare, mean F3 for [`r linguisticsdown::cond_cmpl("iː")`] = `r round(d.SwehVd.forStudy.long.static %>% filter(category == "[iː]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(mean(F3)) %>% pull(), digits = 0)` Hz, SD=`r round(d.SwehVd.forStudy.long.static %>% filter(category == "[iː]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(sd(F3)) %>% pull(), digits = 0)`; mean F3 for [`r linguisticsdown::cond_cmpl("ɪ")`] = `r round(d.SwehVd.forStudy.long.static %>% filter(category == "[ɪ]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(mean(F3)) %>% pull(), digits = 0)` Hz, SD=`r round(d.SwehVd.forStudy.long.static %>% filter(category == "[ɪ]", Normalization.Type == "no normalization (Hz)") %>% ungroup() %>% summarise(sd(F3)) %>% pull(), digits = 0)`), this would seem to suggest more rounding in [`r linguisticsdown::cond_cmpl("ʏ")`] relative to [`r linguisticsdown::cond_cmpl("yː")`].

The results furthermore suggested that static measurements across talkers, while informative, were insufficient to accurately capture the spectral acoustics of some vowels, as indicated by the amount of overlap when static formants were considered. A more exhaustive description can be achieved by including dynamic analyses, as shown in this paper. This was especially true for the [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`],  [`r linguisticsdown::cond_cmpl("uː")`] - [`r linguisticsdown::cond_cmpl("oː")`] and [`r linguisticsdown::cond_cmpl("eː")`] - [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] distinctions, given the direction and scope of formant trajectory movements across the vowel segment. The analysis of the empirical data furthermore suggested that a larger portion of the movement took place at the later part of the segment for most vowels, irrespective of the magnitude of change in F1 and F2. However, [`r linguisticsdown::cond_cmpl("iː")`], [`r linguisticsdown::cond_cmpl("yː")`] and [`r linguisticsdown::cond_cmpl("ʉː")`] constituted important exceptions as they displayed more movement in the first three to four time-points. Of note, some of the short vowels showed formant movements of equal or larger magnitude as certain long vowels, which seems to signal the importance of vowel dynamics for long and short vowels alike. This has been investigated in work on other languages [e.g., @hillenbrand1995; @watson-harrington1999], but has largely been lacking in studies on Swedish. In terms of distinguishing between diphthongization and merely formant movement, the trajectory plots suggested diphthongization towards an open quality in primarily [`r linguisticsdown::cond_cmpl("eː")`] and [`r linguisticsdown::cond_cmpl("oː")`].

GAMMs fit to the data contributed with further insights into the formant dynamics of individual contrasts as well as for vowels differing in quantity, and allowed for an assessment of the relative contribution of formant dynamics to cue dependencies for neighboring and more distant contrasts. For instance, GAMMs fit to the long-short vowel pairs indicated that within all pairs, the two categories were significantly different in predicting the spectral cues in all cue evaluations, with the exception of [`r linguisticsdown::cond_cmpl("ɛː")`]-[`r linguisticsdown::cond_cmpl("ɛ")`] and [`r linguisticsdown::cond_cmpl("ɑː")`]-[`r linguisticsdown::cond_cmpl("a")`] predicting F3. This highlights the informativity carried by formant dynamics for quantity distinctions. The static and dynamics analyses thus both suggest that quantity distinctions are not separate from quality distinctions in Central Swedish.

With regard to the neighboring contrasts hypothesized to rely on formant dynamics---the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] - [`r linguisticsdown::cond_cmpl("ʉː")`] - [`r linguisticsdown::cond_cmpl("eː")`], [`r linguisticsdown::cond_cmpl("oː")`] - [`r linguisticsdown::cond_cmpl("uː")`], [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`], and [`r linguisticsdown::cond_cmpl("øː")`]-[`r linguisticsdown::cond_cmpl("œː")`] contrasts, and their short counterparts---the results indicated significant differences for all comparisons and all cues with the exception of [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`], [`r linguisticsdown::cond_cmpl("ɛː")`] - [`r linguisticsdown::cond_cmpl("æː")`], and [`r linguisticsdown::cond_cmpl("ɛ")`] - [`r linguisticsdown::cond_cmpl("æ")`] predicting F3, and [`r linguisticsdown::cond_cmpl("ɪ")`] - [`r linguisticsdown::cond_cmpl("ʏ")`], [`r linguisticsdown::cond_cmpl("øː")`]-[`r linguisticsdown::cond_cmpl("œː")`] predicting F1. This would seem to suggest that the movements in these vowels along these cues, are not contributing to vowel quality information. For the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] contrast, including F3 under static measures either did not appear to change separability (visualizations), or increased the category separability index relative to F1-F2. However, the F1-F2-F3 index for [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] displayed substantial between-talker variability, and was comparatively low. These results overall seem to indicate that the [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] contrast might primarily be supported by F1-F2 dynamics, or by additional acoustic cues not investigated in this study. There is of course also the possibility that listeners might disambiguate the two categories using primarily visual cues or linguistic information, or perhaps these two categories are not distinguished, which would suggest a merger in process among some of these talkers. A merger might be driven by relaxation of lip-rounding, as supported by the higher F3 values found for [`r linguisticsdown::cond_cmpl("yː")`].

The vowel space as summarized in Table \@ref(tab:swehvd-vowels) suggests shifts in some vowels compared to previous characterizations of Central Swedish. For instance, the [`r linguisticsdown::cond_cmpl("ɛː")`] has lowered substantially compared to earlier mappings of the space [e.g., @engstrand1999; @fant1969; @kuronen2000]. This lowering was anticipated by @riad2014 and supported in @leinonen2010, @gross2016, and @pelzer-boersma2019. Another important shift concerns the fronting of [`r linguisticsdown::cond_cmpl("ɪ")`] and [`r linguisticsdown::cond_cmpl("ʏ")`] and the centralization of [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`], where [`r linguisticsdown::cond_cmpl("ɪ")`] and [`r linguisticsdown::cond_cmpl("ʏ")`] appear to maintain their positions as high front vowels, while [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] have centralized to the mid-center part of the space [see also, @pelzer-boersma2019].^[Unfortunately, @pelzer-boersma2019's study on diphthongization only included the long vowels, it is therefore difficult to know whether the fronting of the short vowels was as pronounced in 2019.] This conflicts with previous work on Swedish as well as other languages demonstrating that short vowels are generally less peripheral and more centralized than their long counterparts [e.g., @clopper2005; @hillenbrand1995]. Besides the already mentioned hypothesis of a possible [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`] merger due to relaxation of lip-rounding in [`r linguisticsdown::cond_cmpl("yː")`], an alternative, yet related, hypothesis is that both, or either, vowels are produced as damped versions, as previously found for talkers of Stockholm Swedish [e.g., @kotsinas1994; @schotz2011]. The presence of a damped [`r linguisticsdown::cond_cmpl("ɨː")`] would be supported by the lower F2 values, as the consonantal offglide in [`r linguisticsdown::cond_cmpl("ɨː")`] lowers F2 [@engstrand2000]. A merger of [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`] into [`r linguisticsdown::cond_cmpl("ɨː")`] has been observed among younger talkers in other regions in Sweden, e.g., for Gothenburg Swedish, as reported by @gross2020. If centralization of [`r linguisticsdown::cond_cmpl("iː")`] is a prerequisite for such a merger, as suggested by @gross2020, the present results might indicate the beginning of a merger. Impressionistic listening by the author did support the presence of a final consonantal glide, similar to [`r linguisticsdown::cond_cmpl("ɨː")`], among the majority of talkers in SwehVd, both male and female. The strength and scope of [`r linguisticsdown::cond_cmpl("ɨː")`] varied across talkers, from a relatively strong [`r linguisticsdown::cond_cmpl("ɨː")`] (18 talkers), to a weaker voiced fricative offglide buzzing [z] (14 talkers), or more of a consonant offglide element similar to [`r linguisticsdown::cond_cmpl("j")`] following [`r linguisticsdown::cond_cmpl("iː")`] (3 talkers). Interestingly, several of the talkers that did not produce any apparent final consonant glide or buzz (12 talkers), seemed to have overall less retracted [`r linguisticsdown::cond_cmpl("iː")`] and [`r linguisticsdown::cond_cmpl("yː")`], hence supporting the hypothesized link between centralization and consonantal offglide.

## Methodological considerations and future directions {#sec:methods-considerations}
Two sets of methodological considerations for the present work not mentioned elsewhere, deserve further discussion. The first set concerns the measuring and evaluation of two of the acoustic cues, F0 and vowel duration. F0 is not considered an important cue to vowel identity in itself and therefore often not included in previous work [e.g., @fant1969; @gross2016; @leinonen2010; @pelzer-boersma2019; @wenner2010]. However, it is known to vary across languages and dialects [e.g., @henton2005; @jacewicz-fox2018; @leung2016; @johnson2005; @mennen2012; @weirich2019], and has been shown to have strong indirect effects on vowel categorization [@barreda-nearey2012; see also work on vowel-intrinsic F0, e.g., @whalen-levitt1995; and the hypothesized use of F0 for tense-lax distinctions in German, @pape-mooshammer2006]. For the above reasons, analysis of F0 was included in this study but limited to reports of mean F0 across the segment for static visualizations. Figure \@ref(fig:swe-vowels-all-cues) confirmed that F0 carried the least information about vowel identity of all cues included in this material. However, given evidence of pitch contours influencing perceived duration and prominence of vowels [e.g., @gussenhoven-zhou2013], one could claim that a more comprehensive acoustic representation of vowels should have included F0 in the dynamic analysis. It is not unreasonable to assume a role for F0 in crowded systems such as the Central Swedish vowel inventory with category overlap and potential mergers [c.f., research on adaptive dispersion, e.g., @liljencrants-lindblom1972; @lindblom1998]. For instance, talkers might combine tone distinction (F0) with voice quality (e.g., creak, or buzzing, as in the damped [`r linguisticsdown::cond_cmpl("ɨː")`]) to increase distinctions between neighboring contrasts [for a review, see e.g., @davidson2021].

For duration, the temporal analysis of the effect of duration on long-short vowel pairs could have been supplemented with measures of consonant ratios, following, e.g., @pelzer-boersma2019, and @schaeffler2005. Since the SwehVd database is publicly available in an online repository (<https://osf.io/ruxnb/>), both the question of consonant ratios and the role of F0 can be addressed in future studies.

The second methodological consideration concerns methods used for assessing category distinguishability. Since the GAMMs were fit to each cue separately, they allowed for separate assessments of the relative weight of each cue, compared to the separability index where the by-cue contributions could only be evaluated indirectly. An inherent limitation in the separability index, as implemented in this paper, is the simplifying assumption that all dimensions within a cue combination carry equal weight. It is therefore not possible to assess whether the relation between the cues in each space is symmetrical or not, that is, in the F1-F2 space, we do not know whether F1 carries as much information as F2 for separability, and vice versa. In addition, given that the comparisons are pairwise, they are limited to explaining the relation between two vowels in a contrast. As such, they cannot inform us of the separability of a given vowel from other neighboring vowels, or the overall category separability in the entire space. This is, however, a limitation that the separability index shares with the GAMMs. Neither of these methods are able to assess the distinguishability or confusability of all vowels under different cue combinations in one analysis. Nor can they inform us of the *perceived* distinguishability, even if it is reasonable to assume that reduced overlap between tokens of neighboring categories would increase intelligibility [e.g., @bradlow1995; @wright2004]. For this, one could fit other types of models, such as a multinomial logistic regression model predicting vowel category from cue combinations, or perceptual models assessing the predicted consequences for perception. In separate work conducted in parallel with this study, we have pursued a similar approach, evaluating the predicted consequences of F3-inclusion for high-front vowel contrasts in Swedish using a perceptual model based on Bayesian inference, ideal observers [@persson-jaeger2024]. The results of including F3 qualitatively replicated the results presented here for the investigated vowels in that it overall improved the predicted recognition accuracy. Compared to measures of category separability, the ideal observers allowed for an assessment of the effect of F3-inclusion on category confusability among all vowels considered. This analysis suggested that while F3-inclusion overall decreased category confusability, especially for [`r linguisticsdown::cond_cmpl("yː")`] and [`r linguisticsdown::cond_cmpl("ʏ")`], it *increased* the probability of confusing [`r linguisticsdown::cond_cmpl("iː")`] with [`r linguisticsdown::cond_cmpl("yː")`].^[In comparison to other model-based approaches such as logistic regression and linear discriminant analysis, Bayesian ideal observers have the advantage of reducing the number of degrees of freedom in the fit from production data to predicting perception, which substantially reduces the risk of over-fitting to the data [see discussion in e.g., @persson-jaeger2023].]

Models predicting perception from production data can further inform the design of perception studies that can shed more light on the consequences of the present results for the perception of Central Swedish vowels. For instance, in a language with a systematic quantity distinction such as Swedish, the role of spectral cues in long-short vowel pair distinctions could be assessed by exposing listeners to synthesized versions where long and short vowel duration is crossed with the allophones' spectral information for any given phoneme. Furthermore, as the results seem to support claims of the hypothesized importance of formant dynamics for vowel distinctions, more insight into the effect of formant dynamics for vowel perception could be gained from having listeners categorize tokens extracted from different segments of the long vowels, e.g., the first three time-points vs. the three final time-points [c.f., @jenkins1994; @strange1989]. The design of such experiments can be informed by modeling the predicted perceptual consequences of different cue spaces, and of considering different vowel segments.

Another avenue for future research to explore, are the preliminary hypotheses mapped out in this section concerning vowel change. Since this study's primary focus is mapping the acoustics of modern-day Central Swedish vowels, systematic investigations of the underlying reasons to the potential shifts in the vowel space compared to previous work, are left for future studies. These hypotheses, and others, could be investigated in perceptual studies or by using systematic listening by trained phoneticians, further validated through measures of inter-rater reliability [for a review, see @cucchiarini1995; @gross2020; @kuronen2000; @pelzer-boersma2019]. Evaluations by trained phoneticians can provide assessments of both auditory distinguishability between categories and the correspondence between assigned IPA label and auditory impression. Perceptual studies with naïve listeners can complement evaluations by phoneticians, as training can differ across phoneticians and introduce biases [for reviews, see e.g., @heselwood-howard2008; @stemberger-bernhardt2020; @kerswill-wright1990]. Relatedly, the extent to which individual talkers are driving these changes could be investigated by assessing the amount of cross-talker variability in SwehVd. This study suggests that even when keeping the background variables age and region of origin constant and normalizing for talker-specificity in physiology, there are still differences in the phonetic realization of some vowels that could be related to sociolinguistic differences. Further insights into these individual differences can be gained by studying the SwehVd materials on a talker-specific level.

# Conclusions
The present study has reported on the acoustic properties of Central Swedish vowels. The spectral and temporal cues investigated all contributed to distinguishing between the 21 vowels in the Central Swedish vowel space, with varying weight. More insight into formant dynamics within and between quantities have been gained by the dynamic analysis presented, which is also of value for cross-linguistic research. 
What has been gained with the broad-scale approach of characterizing the *entire* vowel space adopted here, is of course lost in terms of detailed investigations of individual vowel contrasts. There is certainly a lot more to say about the centralization of [`r linguisticsdown::cond_cmpl("iː")`] - [`r linguisticsdown::cond_cmpl("yː")`], the potential relaxation of lip-rounding in [`r linguisticsdown::cond_cmpl("yː")`], the lowering of [`r linguisticsdown::cond_cmpl("ɛː")`], and the potential role of additional cues beyond those investigated here, among other things. The acoustic descriptions outlined in this paper, together with the publicly available SwehVd database, can provide a reference point for future investigations into these acoustic events and beyond.

\newpage

# Ethics statement {-}
This study on human participants was granted an exemption from requiring ethics approval in accordance with the local legislation and institutional requirements (Etikprövningsmyndigheten, Uppsala, Sweden). The participants provided their written informed consent to participate in this study.

# Data availability statement {-}
The SwehVd dataset presented in this study can be found in an online repository (SwehVd: <https://osf.io/ruxnb/>). All analyses and visualization code can be found in a separate online repository (<https://osf.io/7uvj4/>).

# Funding {-}
The work presented in this study was partially funded by a grant from the Kinander's foundation (2021), a grant from Kungliga Vetenskapsakademien (2023), and by the Department of Swedish Language and Multilingualism at Stockholm University.

# Acknowledgments {-}
Omitted for review<!--I thank audiences at the 2023 ASA meeting, at the Ludwig-Maximilians-Universität Institute for Phonetics and Speech Processing lab meeting October 2023, and at the Stockholm University Department of Swedish language and multilingualism for feedback on earlier presentations of this work. I am particularly grateful to Anders Eriksson for providing the recordings of the SweDia reference talkers, Michele Gubian for advice and support in implementing GAMMs, T Florian Jaeger for advice and support on code development, Tomas Riad for discussion of Swedish vowel systems, Maryann Tan for collaboration in preparation of the SwehVd database, and to Nathan Young for feedback on segmentation procedures, as well as for access to, and support for, the [SweFA software](https://github.com/mcgarrah/LG-FAVE) for the automatic annotation of Swedish vowels. Finally, I thank Niclas Abrahamsson, T Florian Jaeger, Catrin Norrby, Rasmus Puggaard-Rode, Tomas Riad, Maryann Tan, and Carla Wikse Barrow for feedback on earlier versions of the manuscript.-->

# Conflict of Interest {-}
The author declares that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup


```{r, child="SI.Rmd", eval= if (INCLUDE_SI) TRUE else FALSE}
```

